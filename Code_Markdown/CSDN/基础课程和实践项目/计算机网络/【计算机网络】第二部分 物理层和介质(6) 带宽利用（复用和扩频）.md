@[toc]


==实际生活中，**链路都是有限带宽**，合理运用带宽将是电路通信亟待解决的主要问题==。 然而，所谓*合理*是与应用有关，**带宽利用是可用带宽的合理使用**——有时我们需要**将一些低带宽通道组合在一起形成一条高带宽通道**，有时为达到目的又需要**扩展通道带宽**，如保密、抗干扰等。

这里将系统地讨论==带宽合理使用的两个主要类型：复用与扩频==。**在复用中，目标是效率**，将一些通道合并为一个通道；**在扩频中，目标是保密、抗干扰 `privacy and antijamming`**，我们扩展通道的带宽以插入冗余，这是为了达到保密与抗干扰目标所必需的。

---
# 6.1 复用
==只要「连接两台设备的介质带宽」比「设备间传输所要求的带宽」高时，该链路就可以被共享==。**复用** `multiplexing` 就是**允许通过一条数据链路同时传输多个信号**的一组技术。随着数据和电信应用的增加，通信量也不断增加。当然，可以每需要一条新的通道就建立一条单独的链路来满足这种增长，也可以**安装更高带宽的链路，并在这些链路上采用复用技术**。

如[【计算机网络】第二部分 物理层和介质(7) 传输介质](https://memcpy0.blog.csdn.net/article/details/122954366)所述，目前的技术包括诸如**光纤、地面微波和卫星微波**等高带宽介质，每一种介质都具有远超过平均传输需求的承载能力。如果一条链路的带宽，比连接在它的上面的设备所需的带宽要大，那么多余的带宽就被浪费。一个高效的系统可以最大限度地使用所有设备的资源，而**带宽是在数据通信中最为昂贵的资源之一**。

**在复用的系统中，$n$ 条线路共享一条链路的带宽** 。图6.1说明了==复用系统的基本形式——左侧的 $4$ 条线路，将它们的传输流量送到**复用器** `multiplexer, MUX` ，复用器将这些流量组成一个单独的传输流（多对一）；在接收端，这个传输流量被**分离器** `demultiplexer, DEMUX` 接收，并分解成原来几个独立的传输流（一对多），并直接发送到对应的线路上==。
> 图6.1中的**链路** `link` 一词是指**物理通路** `physical path` ，**通道** `channel` 一词是指在给定一对设备之间传送传输信号的链路的那部分 `the portion of a link` 。**一条链路可能有多个通道**。

![图6.1 链路划分为通道](https://img-blog.csdnimg.cn/3ef5425eafd340eaa23ed3273da27e47.png)
信号可以通过三种基本技术进行多路复用：**频分复用** `frequency-division multiplexing，FDM` ，**波分复用** `wave-division multiplexing, WDM` 和**时分复用** `time-division multiplexing,TDM` 。==前两种技术用于模拟信号，第三种技术用于数字信号==（见图6.2）。

虽然有些教科书将**码分复用接入** `carrier division multiple access,  CDMA` 看做是第四种技术，但我们还是把它作为接入方法讨论（见[第12章]()）。
![图6.2 多路复用的类型](https://img-blog.csdnimg.cn/df8a19619d2743d694a49dd29bb61735.png)

## 6.1.1 频分复用（模拟过程）
**频分复用** `FDM` 是一种模拟技术，在链路带宽（以 $\textrm{Hz}$ 为单位）大于要传输的信号的带宽之和时采用。==在FDM中，每个发送设备生成的信号用于调制不同的载波频率，然后将调制后的信号 `These modulated signals` 合并为一个可由链路传输的复合信号。载波频率被足够的带宽隔开，以适应调制后的信号== `modulated signal` 。这些带宽的范围，就是不同信号通过的通道。

通道之间由狭长的未使用的带宽，即**防护频带** `guard band` 带进行分隔，以防止信号重叠。另外，**载波频率必须不会影响原始的数据频率**。不符合以上任一条件就会导致原始信号的不可恢复。

图6.3给出了 FDM的概念描述。图中传输通路分为三部分，每一部分都是传输某一个流量的通道。
![图6.3 频分复用](https://img-blog.csdnimg.cn/fde89b3943ac49769fe58d48b5bd8863.png)
我们认为**FDM是模拟复用技术**，但这并不意味着，FDM不能把源端发送的数字信号组合在一起。在FDM使用复用之前，数字信号可以转换成模拟信号（有关技术在[【计算机网络】第二部分 物理层和介质(5) 模拟传输](https://memcpy0.blog.csdn.net/article/details/123059004)中已讨论)。

### 1. 复用过程
图6.4是多路复用过程的示意图。**FDM是一个模拟过程**。每一个源端产生频率范围类似的信号。在**复用器**中，==这些类似的信号调制不同的载波频率 $f_1, f_2, f_3$ 。然后，将调制后的信号合成为一个单一复合信号，并通过具有足够带宽的介质链路发送出去==。
![图6.4 FDM过程](https://img-blog.csdnimg.cn/ec648b6cef1d4c278bbd3683a533e28a.png)

### 2. 复用分离过程
**分离器**使用一系列**滤波器**，以将复用信号分解为组成它的各个信号。每个信号随后被传送到**解调器**，解调器将它们与载波分离、并转发给等待的接收端。图6.5是FDM复用分离过程的示意图。
![图6.5 FDM分离示例](https://img-blog.csdnimg.cn/84d189f024044f2995fa3024218b0de0.png)

【例6.1】假定一个语音通道占用的带宽是 $4\textrm{kHz}$ 。要将三个语音通道合并到一条带宽为 $12\textrm{kHz} (20\sim 32\textrm{kHz})$ 的链路。使用频域图表示这一配置过程，这里假定不使用防护频带。
解：图示说明如下：
- ==在发送端，将三个语音通道平移（**调制**）到不同的带宽==，如图6.6所示。第一个通道使用 $20\sim 24\textrm{kHz}$ 的带宽，第二个通道使用 $24\sim 28\textrm{kHz}$ 的带宽，第三个通道使用 $28 \sim 32\textrm{kHz}$ 的带宽。然后，如图6.6所示将它们合并。
- ==在接收端，每个通道接收到完整信号后，使用滤波器将自己的信号分离出来==。第一个通道使用能够通过 $20\sim 24\textrm{kHz}$ 频率成分的滤波器，并丢弃任何其他频率成分。第二个通道使用能够通过 $24\sim 28\textrm{kHz}$ 频率成分的滤波器，而第三个通道使用能够通过 $28\textrm{kHz}\sim 32\textrm{kHz}$ 频率成分的滤波器。最后，**每一个通道将频率平移到从 $0$ 开始的起点** `Each channel then shifts the frequency to start from zero` 。
![图6.6 例6.1](https://img-blog.csdnimg.cn/ae7e064f323a4b5eb437dd787844a80c.png)

【例6.2】有 $5$ 个通道，每个通道的带宽是 $100 \textrm{kHz}$ ，全部进行多路复用。如果通道之间需要 $10\textrm{kHz}$ 的防护频带以防止干扰，则链路的最小带宽是多少？
解：对于 $5$ 个通道，至少需要 $4$ 个防护频带。这意味着至少需要带宽 $5 \times 100 + 4 \times 10 = 540\textrm{kHz}$ ，如图6.7所示。
![图6.7 例6.2](https://img-blog.csdnimg.cn/d20b668330954773baaca97c7a57c728.png)

【例6.3】有 $4$ 个**数据通道（数字的）**，每一个通道的传输速率是 $1\textrm{Mbps}$ ，使用 $1\textrm{MHz}$ 的卫星通道。使用FDM设计一种合理的配置。
解：**卫星通道是模拟的**。将其划分为 $4$ 个通道，每个通道的带宽是 $250\textrm{kHz}$ 。对每个 $1\textrm{Mbps}$ 的数字通道进行调制，每 $4$ 位调制为 $1\textrm{Hz}$ 。一种解决方案是 `16-QAM` 调制。图6.8描述了一种可能的配置方案。
![图6.8 例6.3](https://img-blog.csdnimg.cn/509f151a69aa43b8b595b2687e4fd4ad.png)

### 3. 模拟载波系统
电话公司为了最大限度地提高基础设施的效率，传统方式是==把来自低带宽线路的信号复用到更高带宽的线路上==。通过这种方式，可将许多交换和专用线路合并为更少但容量更大的通道。对于模拟线路来说，使用的是FDM技术。

AT&T采用的层次结构系统之一，是由群、超群、主群和巨群组成（见图6.9）。在这个**模拟层次结构** `analog hierarchy` 中：
- $12$ 个语音通道复用到一个更高带宽的线路上，构成一个**群** `group` ，一个群的带宽为 $48\textrm{kHz}$ ，并支持 $12$ 个语音通道。
- 在下一层，最多可以复用 $5$ 个群产生一个称为**超群** `supergroup` 的复合信号。一个超群的带宽是 $240\textrm{kHz}$ ，而且支持多达 $60$ 个语音通道。超群可以由 $5$ 个群构成，或者由 $60$ 个独立的语音通道构成。
- 在下一层，$10$ 个超群复用为一个**主群** `master group` 。 一个主群必须有 $2.40\textrm{MHz}$ 的带宽，但是由于超群之间需要防护频带，使得总带宽上升至 $2.52\textrm{MHz}$ 。主群最多支持 $600$ 个语音通道。
- 最后，$6$ 个主群组合成一个**巨群** `jumbo group` 。巨群必须有  $15.12\textrm{MHz}\ (6 \times 2.52\textrm{MHz})$ 的带宽，但是为了容纳主群之间的防护频带，而调整为 $16.984\textrm{MHz}$ 。 ![图6.9 模拟层次结构](https://img-blog.csdnimg.cn/49e5736b4d794a11ab1cd63e3b58c681.png)

### 4. FDM的其他应用
**FDM的一个最常见的应用是AM或者FM广播**。无线电使用空气作为传输介质。
- 将一个特定波段 $530\sim 1700\textrm{kHz}$ 分配给了AM无线电广播，所有的无线电台需要共享这一波段。如[【计算机网络】第二部分 物理层和介质(5) 模拟传输](https://memcpy0.blog.csdn.net/article/details/123059004)讨论的那样，==每个AM电台都需要 $10\textrm{kHz}$ 带宽，每个电台使用不同的载波频率，这意味着**它要平移它的信号并进行复用**==。

	空气中传播的信号是所有信号的组合。接收机会接收到所有这些信号，但是能够滤波（通过微调 `tuning` ）想要接收的信号。如果没有复用，那么就只会有一个AM电台可以向公共链路（即空气）中广播信号。然而，我们需要知道，**这里有物理的复用器或分离器** `we need to know that there is physical multiplexer or demultiplexer here` ，在[【计算机网络】第三部分 数据链路层(12) 多路访问]()将会看到，**复用是在数据链路层完成的**。
- 这种情况与FM广播类似。但是FM使用的带宽更高，为 $88\sim 108\textrm{MHz}$ ，这是因为每个电台需要更高的带宽，即 $200\textrm{kHz}$ 。

FDM的另一个常见应用是**电视广播**，每一个电视频道的带宽是 $6\textrm{MHz}$ 。

第一代移动电话（仍然在运行）也使用FDM。为每一用户分配两个 $30\textrm{kHz}$ 的通道，一个用于发送语音、而另一个用于接收。语音信号的带宽是 $3\textrm{kHz}\ (300 \sim 3300\textrm{Hz})$ 。使用调频进行调制。要记住：==FM信号的带宽是调制信号的 $10$ 倍，这意味着每个通道要有 $30\textrm{kHz}\ (10 \times 3)$ 的带宽==。这样，每一个用户在呼叫时，由基站提供的某个可用范围内的带宽是 $60\textrm{kHz}$ 。

【例6.4】高级移动电话系统 `AMPS` 使用两个波段。第一个波段是
$824 \sim 849\textrm{MHz}$ ，用于发送，而 $869\sim 894\textrm{MHz}$ 用于接收。每一个用户在每个方向上都有 $30\textrm{kHz}$ 的带宽。==$3\textrm{kHz}$ 语音使用FM调制，生成 $30\textrm{kHz}$ 的调制信号==。试问可以有多少人同时使用移动电话？
解：每一个波段是 $25\textrm{MHz}$ 。如果将 $25\textrm{MHz}$ 按 $30\textrm{kHz}$ 划分，可以得到 $833.33$ 个。实际上，波段划分为 $832$ 个通道。在这些通道中，$42$ 个通道用于控制，意味着只有 $790$ 个通道可用于移动电话用户。[第16章]()会更详细地讨论AMPS 。
### 5. 实现
FDM的实现非常容易。==和无线电或电视广播一样，在多数情况下不需要物理的复用器和分离器，只要所有电台使用不同的载波频率，向空气中广播，就可以实现多路复用==。其他情况下，例如移动电话系统，基站需要为用户分配载波频率。在一个信元内，由于没有足够的可用带宽，所以不能为每一个电话用户分配永久的带宽。当某个用户挂断时，带宽就会分配给其他的呼叫者。

## 6.1.2 波分复用（模拟过程）
**波分复用** `Wavelength-division multiplexing, WDM`  用于具有高数据速率传输能力的光缆。光缆的数据速率比金属传输介质的数据速率高。将光缆用作单一线路浪费了可用带宽。复用则允许将多条线路连接为一条线路。

**WDM在概念上与FDM相同** `WDM is conceptually the same as FDM` ，除了复用和分离 `multiplexing and demultiplexing` 涉及通过光纤通道传输的光信号 `optical signals transmitted through fiber-optic channels` 。其原理是一样的，都是将不同频率的不同信号合并。但其**差别是这些频率非常高**。即**WDM是合并多个光信号的模拟多路复用技术**。

图6.10给出了波分复用的复用器和分离器的示意图。来自不同源端的窄波段的光，合并生成一种波段更宽的光。在接收器端，信号通过信号分离器进行分离。
![图6.10 波分复用](https://img-blog.csdnimg.cn/d115463dfe9545e3ac6665874625f207.png)

尽管WDM这种技术非常复杂，但其想法是非常简单的。==在复用器上，将多个光源组成单一光信号，而在分离器上做相反的处理==。光源的组合与分离由**棱镜** `prism` 完成。普通物理知识告诉我们，棱镜可以根据入射角和频率，将几束光合成一道光。利用这项技术，复用器可组合几束输入光（每束光包含窄带频率）为一束输出光（宽带频率）。分离器做相反的过程。其概念如图6.11所示。
![图6.11 棱镜作为波分复用和分离](https://img-blog.csdnimg.cn/f11c1064351b4f36a30e86f96f5a6359.png)
WDM的一种应用是**同步光纤网络** `SONET` ，其中多条光纤线路进行复用和信号分离。[第17章]()会讨论SONET。


有一种新方法，称为**密集波分复用** `dense WDM, DWDM` ，这种方法通过**使通道彼此间隔得非常近**来复用大量的通道，从而获得非常高的效率。
## 6.1.3 同步时分复用（数字过程）
**时分复用** `time-division multiplexing,TDM` 是一个**数字化过程**，它允许多个连接共享一条高带宽链路，与FDM共享一部分带宽不同的是，**TDM是在时间上共享，每个连接占用链路的一个时间段**。图6.12给出了TDM的示意图。注意：在FDM中使用相同的链路，但是这里表示的链路分割是时间上、而不是频率上的。在时分复用图中，信号 $1, 2,3,4$ 依次占用链路 。
![图6.12 TDM](https://img-blog.csdnimg.cn/7a57e091d51b42fd883ea38f8f6042c1.png)
请注意，在图6.12中，我们只关注多路复用、而不是交换 `switching` 。这意味着，来自源 $1$ 的报文中的所有数据，始终会到达一个特定的目的地，可以是 $1$ 、$2$ 、$3$ 或 $4$ 。与交换不同，这里的传送是固定不变的。

还需要记住，**TDM原则上是一种数字多路复用技术**。来自不同来源的数字数据被合并成一个时间共享的链路 ` timeshared link` 。然而，这并不意味着源不能产生模拟数据；==模拟数据可以采样、转换为数字数据，然后使用TDM进行多路复用== `analog data can be sampled, changed to digital data, and then multiplexed by using TDM` 。 

我们可将TDM划分成两种方案：同步的与统计的。首先讨论**同步的时分复用** `synchronous TDM` ，然后说明它与**统计的时分复用** `statistical TDM` 有那些不同。在同步的TDM中，即使它不发送数据，每个输入端允许连接到输出端 `each input connection has an allotment in the output even if it is not sending data` 。

### 1. 时隙和帧
==在同步TDM中，每个输入连接的数据流被划分为多个单元（一个单元 `unit` 可以是一位、一个字符或一个数据块），其中每个输入占用一个**输入时隙**==。**每个输入单元成为一个输出单元，占用一个输出时隙**。多个输出单元（输出时隙）组成一个帧。

然而，一==个输出时隙的持续时间，是一个输入时隙持续时间的 $n$ 分之一。如果输入时隙是 $T$ 秒，则输出时隙是 $T/n$ 秒，其中 $n$ 是连接数==。换言之，输出连接中的单元 `a unit in the output connection ` 具有较短的持续时隙，输出速率更快。图6.13显示了同步TDM一个实例，其中 $n$ 为 $3$ 。

在同步TDM中，**来自每个输入连接的一轮数据单元 `a round of data units` 组成一个输出帧**（不久将会看到其理由）。如果有 $n$ 条连接线，则一帧划分成 $n$ 个时隙，一个时隙分配给一个单元。==如果输入单元持续 $T$ 秒，则每个输出时隙持续时间是 $T/n$ ， 而每个帧持续时间是 $T$== （除非帧携带其他信息，这不久将会看到）。
![图6.13 同步时分复用](https://img-blog.csdnimg.cn/74f79801af8643818d6e292bee8c9df6.png)
==在同步TDM中，输出链路的数据速率（链路速率）必须是单个连接的数据速率的 $n$ 倍，以确保数据流动==。在图6.13 中，（输出）链路数据速率是一条（输入）连接的数据速率的 $3$ 倍。同样，一条连接中的一个单元的持续时间是输出时隙（链路中一个单元的持续时间）的 $3$ 倍。图中，将复用之前的数据表示为复用后数据大小的 $3$ 倍。这只是表达一种思想，即**每个单元在复用之前的持续时间是复用后的 $3$ 倍**。

时隙分组为多个帧。==一个帧由「多个时隙组成的一个完整的时隙周期」组成，每个发送设备专用一个时隙==。在具有 $n$ 条输入线路的系统中，每个帧有 $n$ 个时隙，分配每个时隙用于传送来自特定输入线路的数据。

【例6.5】在图6.13 中，每个输入连接的数据速率是 $1\textrm{kbps}$ ，**一个单元为 $1$ 位**。试确定：1) 每个输入单元的时隙；2) 每个输出单元的时隙；3) 每个帧的时隙。
解：这些问题回答如下：
1. 每个输入连接的数据速率是 $1\textrm{kbps}$ ，这就是说位持续时间是 $1/1 000$ 秒，即 $0.001\textrm{s} \ (1\textrm{ms})$ 。==输入时隙的持续时间是 $1\textrm{ms}$（与位持续时间相同）==；
2. 每个输出时隙的持续时间是输入时隙的三分之一，这说明输出时隙的持续时间是 $1/3\textrm{ms}$ 。
3. 每个帧具有三个输出时隙，因此一个帧持续时间是 $3\times 1 /3 \textrm{ms} = 1\textrm{ms}$ 。

【例6.6】图6.14表示了 $4$ 个输入数据流和 $1$ 个输出数据流的同步TDM，**数据单元是一位**。试求：1) 输入位的持续时间；2) 输出位的持续时间；3) 输出比特率；4) 输出帧的速率。
解：这些问题回答如下：
1. 输入位的持续时间是速率的倒数： $1/1\textrm{Mbps}=1\textrm{μs}$ ；
2. 输出位持续时间是输入位持续时间的四分之一，即 $1/4\textrm{μs}$ ；
3. 输出比特率是输出位持续时间的倒数，即 $4\textrm{Mbps}$ 。这也可从输出速率比输入速率快 $4$ 倍这一事实推出，即输出速率 $=4 \times 1 \textrm{Mbps}=4\textrm{Mbps}$ ；
4. **帧速率始终与任一输入的速率相同** `The frame rate is always the same as any input rate` ，因此帧速率是每秒 $1 000 000$ 帧。因为我们发送每帧 $4$ 位，所以我们可以通过**将帧速率乘以每帧的位数**（得到链路的输出速率），验证前面问题的结果。
![图6.14 例6.6](https://img-blog.csdnimg.cn/c9368439f3bb4d62aefd1088d9a8f4ec.png)

【例6.7】将 $4$ 个 $1\textrm{kbps}$ 的连接一起复用，**每个单位为 $1$ 位**，试求：1) 复用前一位持续的时间；2) 链路传输速率；3) 时隙持续时间；4) 一帧持续时间。
解：各小题解答如下：
1. 复用前一位持续时间是 $1 / 1\textrm{kbps}$ ，即 $0.001$ 秒（$1\textrm{ms}$）；
2. 链路速率是连接速率的 $4$ 倍，即 $4\textrm{kbps}$ ；
3. 每个时隙持续时间是复用前每位持续时间的四分之一，即 $250\textrm{μs}$ 。注意：也可以从链路数据速率 $4\textrm{kbps}$ 来计算。位持续时间是数据速率 $1 /4 \textrm{kbps}$ 的倒数，即 $250\textrm{μs}$ ；
4. **帧持续时间总是与复用前一个单元的持续时间相同**，即 $1\textrm{ms}$ 。我们也可以从另一个方法计算，此时每帧有 $4$ 个时隙，所以一个帧持续时间是 $250\textrm{μs}$ 的 $4$ 倍，即 $1\textrm{ms}$ 。

### 2. 交替
==**TDM可以看作是两个快速旋转的开关**，一个位于复用一侧，另一个位于信号分离一侧。两个开关是**同步**的，以**相同的速度**旋转，但是**方向相反**==。在复用一侧，当开关在一个连接前打开时，连接即有机会向通路上发送一个单元。这个过程称为**交替** `interleaving` 。在信号分离一侧，当开关在某个连接前打开时，连接即有机会从通路中接收一个单元。

图6.15 画出了图6.13所示连接的交替过程。图中暂时不考虑交换，假定来自复用器一端的第一个连接的数据，传输到信号分离器一端的第一个连接中。[【计算机网络】第二部分 物理层和介质(8) 交换](https://blog.csdn.net/myRealization/article/details/122158560)讨论交换。
![图6.15 交替](https://img-blog.csdnimg.cn/6a9b73a66e6d4fa28c7cc17f53d5d1e2.png)
【例6.8】$4$ 个通道使用TDM实现复用。如果每个通道的发送速度是 $100$ 字节/秒，**每个通道复用 $1$ 字节**，试画出链路中帧的传输情况，说明帧的大小、帧的持续时间、帧传输速率以及链路的比
特率。
解：复用器如图6.16所示。每帧从每个通道中传送 $1$ 字节。所以每个帧的大小是 $4$ 字节，即 $32$ 位。因为每个通道发送速率是 $100$ 字节/秒，一帧从每个通道中运送一个字节，**帧传输速率必须是每秒 $100$ 帧**。所以，每帧的持续时间是 $1/100$ 秒。链路每秒钟运送 $100$ 帧，每帧包含 $32$ 位，所以比特率是 $100\times 32 = 3 200\textrm{bps}$ 。这实际上是每个通道的比特率（每个通道的比特率是 $100 \times 8 = 800 \textrm{bps}$）的 $4$ 倍。
![图6.16 例6.8](https://img-blog.csdnimg.cn/38339753e6b448b0bbd9cbd5a9f10dca.png)

【例6.9】复用器使用 $2$ 位的时隙，合并 $4$ 个 $100\textrm{kbps}$ 的通道。试画出带有 $4$ 个任意输入的输出结果。帧速率是多少？帧的持续时间是多少？比特率是多少？位持续时间是多少？
解：图6.17画出了任意 $4$ 个输入的输出结果。由于每帧包含每个通道的 $2$ 位，每帧的大小为 $8$ 位，即 $1$ 字节。所以链路每秒钟传输 $50000$ 帧。每帧的持续时间是 $1/50000$ 秒，即 $20\textrm{μs}$ 。帧速率是 $50000$ 帧/秒，每帧运送 $8$ 位，比特率是 $50000 \times 8 =400000$ 位，即 $400\textrm{kbps}$ 。位持续时间是 $1/400000\textrm{s} = 2.5\textrm{μs}$。注意：==帧的持续时间是位持续时间的 $8$ 倍，因为每帧运送 $8$ 位==。
![图6.17 例6.9](https://img-blog.csdnimg.cn/6e22cc460f624a8b84899c1052c8a7c2.png)
### 3. 空时隙
同步TDM的频率并不高。当某一源端没有数据发送时，输出帧中对应的时隙是空的。图6.18表示了其中一条输入线没有数据发送、而另一输入线中一个时隙有不连续数据的情况。
![图6.18 空时隙](https://img-blog.csdnimg.cn/d2dd8ed5e3a0476a9c2c6ffeefb1c541.png)
第一个输出帧填有三个时隙，第二个帧填有两个时隙，而第三个帧填有三个时隙，没有一个帧是填满的。下一节讨论**通过除去帧中空时隙来提高效率**的统计TDM。

### 4. 数据速率管理
TDM中的一个问题是**如何处理输入数据速率的差异**。直到目前为止，都假定所有输入数据的速率都是相同的。==当数据速率不同时，可用三种策略或这三种策略的组合==：它们是**多级复用** `multilevel
multiplexing` 、**多时隙分配** `multiple-slot allocation` 和**脉冲填充** `pulse
stuffing` 。
- **多级复用**：==当一条输入数据线的数据速率是其他一些输入数据线数据速率的整倍数时，可采用多级复用技术==。例如，在图6.19中，有两条 $20\textrm{kbps}$ 的输入线和三条 $40\textrm{kbps}$ 的输入线，前面两条输入线可一起复用，以提供与后面的三条相同的数据速率，这两级复用产生 $160\textrm{kbps}$ 的输出。 
![图6.19 多级复用](https://img-blog.csdnimg.cn/a1f7b43edcd84badb2ef7e0ddcc2484f.png)
- **多时隙分配**：==有时，在一个帧中，允许对一条输入线分配多个时隙，这样更有效率==。例如，可能有一条输入线的数据速率是其他输入线数据速率的倍数。图6.20中，具有 $50\textrm{kbps}$ 数据速率的输入线在输出中可分配两个时隙，这可通过**插入串并行转换、使原输入线分成两个输入线**实现。
![图6.20 多时隙复用](https://img-blog.csdnimg.cn/45abeca4b61448cc948b6aa1882208d4.png)
- **脉冲填充**：==有时源输入线的比特率，不是其他每个输入线比特率的整数倍，上面两种技术都不能使用==，此时解决办法是，**选取输入线最高速率作为主要速率，然后将所有低速率的输入线添加虚位**。这种技术称为脉冲填充/位填充。其想法如图6.21所示，具有 $46\textrm{kbps}$ 的输入线填充脉冲、使其速率增加到 $50\textrm{kbps}$ ，此时就可以复用了。
![图6.21 脉冲填充](https://img-blog.csdnimg.cn/b4fa92758b5244ac929b92d08f6086e2.png)

### 5. 帧同步
TDM的实现不如FDM简单。**复用器和分离器之间的同步**是一个主要问题：==如果复用器和分离器失去同步，则属于某一个通道的位可能会被错误的通道所接收==。由于这个原因，通常在每帧的开始，增加一个或者多个同步位。这些位称为**帧指示位** `framing bit` 。==帧指示位按照某种模式逐帧发生变化，使分离器与输入流同步，以准确地分离时隙==。多数情况下，每帧的同步信息由 $1$ 位构成，交替变化为 $0$ 和 $1$ ，如图6.22所示。
![图6.22 帧指示位](https://img-blog.csdnimg.cn/20028118df634ed9b71903b757fef050.png)
【例6.10】有 $4$ 个数据源，每个数据源每秒种产生 $250$ 个字符。如果交替的单元是 $1$ 个字符，每帧增加 $1$ 个同步位。试确定：1) 每个数据源的数据速率；2) 每个数据源中每个字符的持续时间；3) 帧速率；4) 每帧的持续时间；5) 每帧的位数；6) 链路的数据速率。
解：回答问题如下：
1. 每个数据源的数据速率是 $250 \times 8 = 2000\textrm{bps} = 2\textrm{kbps}$ 。
2. 每个数据源每秒发送 $250$ 个字符，所以每个字符的持续时间是 $1 / 250\textrm{s}  =4 \textrm{ms}$ 。
3. 每帧含有每个数据源的 $1$ 个字符，意味着链路需要每秒发送 $250$ 帧，以保持每个数据源的传输率。
4. 每帧的持续时间是 $1/250\textrm{s} = 4\textrm{ms}$ 。注意，==每帧的持续时间与「来自各个数据源的每个字符的持续时间」相同==。
5. 每帧传送 $4$个字符和 $1$ 个附加的同步位。这表示每帧是 $4\times 8+ 1 =33$ 位。
6. 链路每秒钟发送 $250$ 帧，每帧包含 $33$ 位。这表示链路的数据速率是 $250 \times 33$ ，即 $8250\textrm{bps}$ 。该链路的数据速率高于 $4$ 个通道的比特率之和。若将 $4$ 个通道的比特率相加，结果是 $8000\textrm{bps}$ 。由于每秒传输 $250$ 帧，同时每一帧包含附加的 $1$ 位用于同步，所以要在结果中再加上 $250$ ，即得 $8250\textrm{bps}$ 。

【例6.11】两个通道，一个通道的比特率是 $100\textrm{kbps}$ ，而另一个通道的比特率是 $200\textrm{kbps}$ ，对它们实现多路复用。如何实现？帧速率是多少？每帧的持续时间是多少？链路的比特率是多少？
解：可以为第一个通道分配一个时隙，而为第二个通道分配两个时隙。每帧传送 $3$ 位。由于它从第一个通道中传送 $1$ 个位，所以帧速率是 $100 000$ 帧/秒。每帧的持续时间是 $1 / 100 000\textrm{s}  = 10\textrm{μs}$ 。比特率是 $100 000$ 帧/秒 $\times 3$ 位/帧，即 $300\textrm{kbps}$ 。注意，由于每帧从第一个通道中传送 $1$ 个位，第一个通道的比特率得到保持。因为每帧从第二个通道中传送 $2$ 个位，所以第二个通道的比特率也得到保持。

### 6. 数字信号服务和T线路
电话公司通过一种数字信号的层次结构实现TDM，称为**数字信号** `digital signal, DS` **服务**或**数字层次结构** `digital hierarchy` 。图6.23说明了每一级支持的数据速率。
![mmn jnnnnbnnnnkjhnjjhbghnklmn mk,mn bvcvbn,./。你表，。；、](https://img-blog.csdnimg.cn/d6cd64707bff4adb96a8c06f2f188c09.png)
- `DS-0` 服务是 $64\textrm{kbps}$ 的**单一数字通道**。
- `DS-1` 是一种 $1.544\textrm{Mbps}$ 的服务。这是 $24 \times 64\textrm{kbps}$ 加上 $8\textrm{kbps}$ 的开销得到的。可以用做单一的 $1.544\textrm{Mbps}$ 传输服务，或者作为 $24$ 个 $64\textrm{kbps}$ 通道的多路复用，或者用户需要时，还可以用在适合于 $1.544\textrm{Mbps}$ 容量的、其他服务类型的组合形式。
- `DS-2` 是一种 $6.312\textrm{Mbps}$ 服务。这是 $96 \times 64\textrm{kbps}$ 加上 $168\textrm{kbps}$ 的开销得到的。可以用做单一的 $6.312\textrm{Mbps}$ 传输服务，或者用做 $4$ 个 `DS-1` 通道的多路复用，或者用做 $96$ 个 `DS-0` 通道，或者用做这些服务类型的组合形式。
- `DS-3` 是一种 $44.376\textrm{Mbps}$ 服务。这是 $672 \times 64\textrm{kbps}$ 加上 $1.368\textrm{Mbps}$ 开销得到的。可以用做单一的 $44.376\textrm{Mbps}$ 传输服务，或者用做 $7$ 个 `DS-2` 通道的多路复用，或者用做 $28$ 个 `DS-1` 通道，或者用做 $672$ 个 `DS-0` 通道，或者用做这些服务类型的组合形式。
- `DS-4` 是一种 $274.176\textrm{Mbps}$ 服务，这是 $4 032 \times 64\textrm{kbps}$ 加上 $16.128\textrm{Mbps}$ 开销得到的。可以用做 $6$ 个 `DS-3` 通道的多路复用，或者用做 $42$ 个 `DS-2` 通道，或者用做 $168$ 个 `DS-1` 通道，或者用做 $4032$ 个 `DS-0` 通道，或者用做这些服务类型的组合形式。


`DS-0` 、`DS-1` 等是服务的名称。为了实现这些服务，电话公司使用 **T线路** `T lines`（`T-1` 到 `T-4`）。这些线路的容量与 `DS-1` 到 `DS-4` 的数据速率是精确匹配的（见表6.1）。
![表6.1 DS和T线路速率](https://img-blog.csdnimg.cn/29040674a7a14d42b36730cf4679ca6e.png)
`T-1` 线路用于实现 `DS-1` ，`T-2` 线路用于实现 `DS-2` 等。从表6-1中可以看出，`DS-0` 实际上没有作为服务提供，但是它被定义为用于参考的基础。

#### (1) 用于模拟传输的T线路
**T线路是为数字数据、音频或者视频设计的数字线路**，但它也可以用于模拟传输（常规的电话连接）。前提是要**先对模拟信号采样，然后使用TDM** `the analog signals are first sampled, then time-division multiplexed` 。

==能够使用T线路作为模拟信号载体，为电话公司开启了新的服务时代==。早期，如果某个组织机构需要 $24$ 条单独的电话线路，需要从公司到中心交换机安装 $24$ 条双绞线电缆。现在，那些组织机构可以把 $24$ 条线路合并为一条 `T-1` 线路，并且只靠这一条 `T-1` 线路，即可进行数据交换。图6.24说明了，如何将 $24$ 个语音通道多路复用为一条 `T-1` 线路（参考[第4章]()的PCM编码)。
![图6.24 用于电话线路多路复用的T-1线路](https://img-blog.csdnimg.cn/0188ab6384294e52b67c6076fdb11d8b.png)
#### (2) T-1帧
上面提到过，`DS-1` 需要 $8\textrm{kbps}$ 的开销。为了理解这种开销是如何计算出来的，必须考查 $24$ 条语音通道的帧的格式。

用于 `T-1` 线路的帧通常是 $193$ 位，分为 $24$ 个 $8$ 位的时隙，每帧附加 $1$ 位用于同步（$24\times 8+1=193$），见图6.25。换句话说，每个时隙包含来自每个通道的信号片段。$24$ 个片段在帧中交替排列。如果一条 `T-1` 线路传送 $8 000$ 帧，那么数据速率（即线路的容量）是 $193 \times 8000= 1.544\textrm{Mbps}$ 。
![在这里插入图片描述](https://img-blog.csdnimg.cn/ae4c2427ad614223bdf2a1d7619a19bb.png)

#### (3) E线路
欧洲使用的T线路版本称为**E线路** `E line` 。这两种系统在概念上是相同的，但是容量不同。表6.2列出了E线路及其容量。
![表6.2 E线路的速率](https://img-blog.csdnimg.cn/640d1c79b3844e78aa51b15ca34a41ae.png)

### 7. 同步TDM的其他应用
一些第二代移动电话公司使用同步TDM。例如，前面讨论过的移动电话数字版本，仍然将可用带宽划分为多个 $30\textrm{kHz}$ 的波段。对于每一个波段，使用TDM使 $6$ 个用户可以共享这一波段。这表示每个 $30\textrm{kHz}$ 的波段现在由 $6$ 个时隙构成，用户的数字化语音信号就插入到这些时隙中。使用TDM，每个区域的电话用户的数量现在增加到 $6$ 倍以上。在[第16章]()讨论第二代移动电话。

## 6.1.4 统计时分复用
在上一节看到，==在同步TDM中每个输入在输出帧中都占有一个时隙，如果有些输入线没有数据发送，那么效率就不高==。在统计时分复用中，**动态地分配时隙以提高带宽的效率**：==仅当输入线有发送数据，时隙才有意义，并在输出帧中给予一个时隙==。在统计复用中，每个帧中时隙的个数小于等于输入线的条数。复用器循环顺序地检测每条输入线，如果输入线有数据发送，则对输入线分配一个时隙，否则跳过这条线检测下一条线。

图2.26表示了一个同步和一个统计TDM的例子，前一个例子由于对应的线没有数据发送，某些时隙是空的。然而在后一个例子中，只要有一条输入线有数据要发送，那么就没有空的时隙。
![图6.26 TDM时隙比较](https://img-blog.csdnimg.cn/73d607278bb94f8c99f041bf57ecf256.png)
### 1. 寻址
图6.26也表明了同步TDM和统计TDM时隙之间的主要差别。在同步TDM中，**输出时隙全部由数据占用**；而在统计TDM中，**输出时隙需要携带数据和目的地址**。
- ==在同步TDM中不需要寻址，作为输入和输出的地址之间，关系是同步的和指定的==。例如，我们知道输入线 $1$ 总是转到输出线 $2$ ，如果复用器与分离器是同步的，这是可以保证的。
- 在统计TDM中，由于输入和输出之间不存在指定或预定的时隙，它们之间没有固定的关系，==需要在每个时隙中包含接收方地址、以表明将要传送的地方==。最简单的寻址形式可以是 $n$ 位，以定义 $N$ 个不同的输出线， 其中 $n =\log_2N$ 。例如，对于 $8$ 条输出线，需要 $3$ 位地址。

### 2. 时隙大小
因为在统计TDM中时隙携带数据和地址，**为了传输的效率，数据长度与地址长度之比率必须合理**。例如，每个时隙发送 $1$ 位数据而地址是 $3$ 位，这样做效率很低。这就是说开销是百分之三百。==在统计TDM中，通常一个数据块有许多字节、而地址只有很少字节==。
### 3. 没有同步位
统计TDM与同步TDM还有一个不同，但这次是在帧级别。**统计TDM中的帧不需要同步，所以我们不需要同步位** `The frames in statistical TDM need not be synchronized, so we do not need synchronization bits` 。
### 4. 带宽
在统计TDM中，**链路的容量通常小于每个通道容量之和**。统计TDM的设计者按照每条通道负载的统计 `the statistics of the load for each channel` 确定链路的容量。如果平均只有 $x\%$ 的输入时隙被填满，则链路的容量反映这一点。当然，在高峰时期，某些时隙需要等待。

---
# 6.2 扩频
复用把来自某些源端的信号组合在一起获得带宽的效率，链路的有用带宽在各个源端之间划分。在**扩频** `spread spectrum, SS` 中，也把来自某些源端的信号组合在一起形成一个更宽的带宽，可是目的略有不同。**扩频是为无线应用而设计的**（LAN与 WAN），在这些类型的应用中，**我们所关注的问题比带宽效率更为重要**——==在无线应用中，所有站点都以空气（或真空）作为通信传输介质，共享这介质需要没有窃听者拦截，也需要没有恶意的入侵者的干扰==（例如，军事行动）。

为达到此目的，**扩频技术增加了冗余部分**，它们扩展原始信号的频带以满足每个站的需要。如果每个站要求的带宽是 $B$ ， 扩频将带宽扩展到 $B_{ss}$ ，这里 $B_{ss}>>B$ 。**扩大的带宽允许源端用有防护的封装，将它的报文进行更安全的传输**，类似发送精美的礼品，我们可以把它放在特制礼盒中，以防止在运输过程中受到损坏，我们还可以使用优质的送货服务 `a superior delivery service` 来保证包裹的安全。 

图6.27表示了扩频的思想，**扩频通过两个原则达到它的目的**：
1. 对每个站点需要分配的带宽，显然要比它所需要的带宽更大；
2. 原来的带宽 $B$ 扩大到 $B_{ss}$ 。必须由一个与原来的信号无关的过程 `a process that is independent of the original signal` 来做。换言之，**信号由源端生成后，扩频过程才发生**。
![图6.27 扩频](https://img-blog.csdnimg.cn/2fcacbd2f3ec478db5b96fdb10df39e1.png)

**信号由源端生成后，扩频过程利用扩频代码并扩大带宽**，图中表示了原来的带宽 $B$ 和扩大的带宽 $B_{ss}$ 。扩频代码是伪随机二进制数据流，但它实际上是一种模式。
## 6.2.1 跳频扩频 `FHSS`
**跳频扩频** `frequency hopping spread spectrum, FHSS` 是**用源信号调制 $M$ 个不同的载波频率**。在某一时刻用信号调制 $1$ 个载波频率，在下一时刻信号调制另一个频率。==虽然调制是一次使用一个频率，但在最终用了 $M$ 个频率。源信号扩展后占用的带宽是 $B_{FHSS}>>B$== 。

图6.28表示了FHSS的总的设计概况。称为**伪随机噪声** `pseudorandom noise, PN` 的**伪随机代码生成器** `pseudorandom code generator` 对**每个跳周期** `hopping period` $T_h$ 生成一个 $k$ 位模式。频率表使用这个模式查找用于该跳频周期的频率，并将其传递给频率合成器。频率合成器生成该频率的载波信号，**源信号调制这个载波信号**。
![图6.28 跳频扩频(FHSS)](https://img-blog.csdnimg.cn/c393fde3581a46cfa238428e26a2f586.png)
假定我们决定采用 $8$ 个频率，这是实际应用最简单的例子，但恰好说明问题。此时，$M= 8$ ，$k= 3$ ，伪随机代码生成器将生成 $8$ 个不同的 $3$ 位模式，这些映射到频率表中 $8$ 个不同的频率（见图6.29）。
![图 6.29 FHSS 中频率的选择](https://img-blog.csdnimg.cn/bfb1871d05b04daba2d34d129c6cb72d.png)
这个站点的模式是 $101, 111, 001, 000, 010, 110, 011, 100$ 。注意：==模式是伪随机的，它在 $8$ 次跳后重复循环==。这就是说，在跳周期 $1$ ，模式是 $101$ ，所选的频率是 $700\textrm{kHz}$ ，源信号调制这个载波频率。所选第 $2$ 个模式是 $111$ ，它选中 $900\textrm{kHz}$ 的载波。第 $8$ 个模式是 $100$ ，所选的频率是 $600\textrm{kHz}$ 。==$8$ 次跳频后，模式重复，再从 $101$ 开始==。图6.30表示了信号如何从载波跳到载波的循环，并假定源信号要求的带宽是 $100\textrm{kHz}$ 。
![图6.30 FHSS循环](https://img-blog.csdnimg.cn/e5f1a4cf90094864b8559264d54686c8.png)
可以证明，该方案能够实现上述目标。==当有许多个 $k$ 位模式、而跳周期是短的，那么发送方和接收方可具有保密性==。如果入侵者企图窃听传输信号，他仅能获取很少一部分数据，因为他不知道扩频序列，不能很快地使他能适应下一跳变。一个怀恶意的发送者可能会将噪声发送到一个跳周期中（随机地）干扰信号，但不是全部周期。==这个方案也有抗干扰的效果==。

### 带宽共享
==如果跳频数是 $M$ ， 那么可将 $M$ 个通道复用为使用同一带宽 $B_{ss}$ 的一个通道==。由于一个站点在每跳周期中只用一个频率，其他 $M- 1$ 个站点可使用另外的 $M- 1$ 个频率。换言之，==如果使用适当的调制技术，比如多FSK `MFSK` ，$M$ 个不同站点可用同一带宽 $B_{ss}$== 。

**FHSS与FDM相似** `FHSS is similar to FDM` ，如图6.31所示。图6.31表示了使用FDM的 $4$ 个通道与使用FHSS的 $4$ 通道的例子。==在FDM中，每个站点用带宽的 $1/M$ ， 是固定的分配；在FHSS中，每个站点占用带宽的 $1/M$ ， 但跳到跳改变分配==。 
![图6.31 带宽共享](https://img-blog.csdnimg.cn/176d40ab3512413aab0edca972ac189d.png)
## 6.2.2 直接序列扩频
**直接序列扩频** `direct sequence spread spectrum, DSSS` 技术也是**扩大源信号的带宽**，但方法不同。在 `DSSS` 中，每个数据位用扩展编码的 $n$ 位代替。换言之，==每一位被编码为 $n$ 个**码片** `chip` ，此处码片的速率是数据比特率源信号的 $n$ 倍==。图6.32表示了DSSS的概念。
![图6.32 DSSS](https://img-blog.csdnimg.cn/9c9e70154c8c434d9af6aab129a7071d.png)
作为实例，让我们考察**无线局域网中所用的直接序列扩频**，著名的**巴克序列** `Barker sequence` ，此时 $n=11$ 。假定源信号与码片生成器中的码片使用极性 `NRZ` 编码。图6.33表示了码片、将原始数据乘以码片得到扩展信号的结果 `the result of multiplying the original data by the chips to get the spread signal` 。

在图6.33中，扩频码是模式为 $10110111000$（该例子中）的 $11$ 位码片。如果源信号的速率是 $N$ ， 则扩频信号的速率是 $11N$ 。这就是说，扩频信号要求的带宽比源信号带宽大 $11$ 倍。==如果入侵者不知道该编码，扩频信号可提供保密；如果每个站点使用不同的编码，它也可提供抗干扰的能力==。
![图6.33 DSSS的例子](https://img-blog.csdnimg.cn/346ce05b38fd4cbb86a948ec5b2173c4.png)

### 带宽共享
在DSSS中能否像FHSS一样能共享带宽？回答**不是，也可能是**。==如果我们使用一个扩频代码去扩频（来自不同的站的）无法组合和分离的信号，则不能共享带宽==。例如，在[【计算机网络】第三部分 数据链路层(14) 无线局域网和蓝牙技术](https://memcpy0.blog.csdn.net/article/details/122975021)中看到，某些无线局域网使用DSSS ，但扩频带宽不能被共享。

然而，==如果使用一种特殊类型的序列代码，它允许组合和分离扩频信号，则可共享带宽==。在[【计算机网络】第三部分 数据链路层(16) ]()看到，一个特殊的扩频代码允许在移动电话中使用DSSS，并在多个用户之间共享带宽 `share a bandwidth between several users` 。

