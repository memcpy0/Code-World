> 参考算法导论第29章 线性规划

@[toc]


==在给定有限的资源和竞争性约束的情况下，很多问题都可以表述为最大化或最小化某个目标== `Many problems take the form of maximizing or minimizing an objective, given limited resources and competing constraints` 。==如果可以把目标指定为某些变量的一个线性函数，而且可以把资源上的约束指定为这些变量的等式或不等式，那么我们得到一个**线性规划问题**== `linear-programming problem` 。线性规划出现在许多实际应用中，我们从研究一次政治选举的应用开始。
> 假设作为一位政治家试图赢得一场选举，选区有三种不同类型的区域——市区、郊区和乡村。这些区域分别有 $100 000,\ 200 000,\ 50 000$ 个登记选民。尽管不是所有登记选民都会去投票站投票，但为了确保当选，你希望这三个选区中每个选区都至少有一半登记选民投票给你。
> <b></b>
> 你意识到，在某些地方、某些议题对赢取选票更有效。你的首要议题是修建更多的道路、枪支管制、农场补贴、增加汽油税以改进公共交通。根据竞选班子的研究，你可以估计通过在每项议题上花费 $1000$ 刀做广告、在每个选区可以赢取或输掉多少选票。图29-1给出这种信息，在此表格中，每个条目表明通过花费 $1000$ 刀广告费支持某个特定议题、在市区/郊区/乡村可以赢得选民的千人数，负数项表示失去的选民数。你的任务是，计算出需要花费最少的钱数，以赢得 $50 000$ 张市区选票、$100 000$ 张郊区选票和 $25000$ 张乡村选票。
![在这里插入图片描述](https://img-blog.csdnimg.cn/fde56b2e5848499999d21348b3e36aa6.png)
你可以通过反复试验，设计一种策略赢得所需选票数，但你的这种策略可能不是花费最少的。例如，可以支出 $20000$ 刀广告费用于修建道路、$0$ 刀给枪支管制、$4000$ 刀给农场补贴、$9000$ 刀给汽油税。这种情况下，将赢得 $20 (-2) +0(8) + 4(0) + 9(10) = 50$ 千张市区选票、$20(5)+0(2)+4(0)+9(0) = 100$ 千张郊区选票、以及 $20(3) + 0(-5) +4(10) + 9(-2) = 82$ 千张乡村选票。你将在市区和郊区正好赢得想要的票数、而在乡村地区超过所需票数（事实上，在乡村地区，得到的选票比选民数量还多）。为了累积这些选票，需要付出 $20+0+4+9 = 33$ 千刀的广告费。
<b></b>
你可能怀疑是否你的策略是最好的，即你是否能花更少的广告费来达到你的这些目标？额外的反复试验或许可以帮你回答这个问题，但一个系统化的方法更好。

我们将以数学化的语言描述上述问题，先引入四个变量：
- $x_1$ 是花费在修建道路广告上的金额（千刀）。
- $x_2$ 是花费在枪支管制广告上的金额（千刀）。
- $x_3$ 是花费在农场补贴广告上的金额（千刀）。
- $x_4$ 是花费在汽油税广告上的金额（千刀）。

 我们可以将赢得至少 $50 000$ 张市区选票的需求写成：$$-2x_1 + 8x_2 + 0x_3 + 10x_4 \ge 50 \tag{29.1}$$ 类似地，我们可以将赢得至少 $100 000$ 张郊区选票的需求写成：$$5x_1 + 2x_2 + 0x_3 + 0x_4 \ge 100 \tag{29.2}$$ 我们可以将赢得至少 $25 000$ 张乡村选票的需求写成：$$3x_1 - 5x_2 + 10x_3 - 2x_4 \ge 25\tag{29.3}$$ 任何一组满足不等式 $(29.1) \sim (29.3)$ 的变量 $x_1, x_2, x_3, x_4$ 取值，构成一种能够赢得足够数量选票的策略。为了使花费尽可能小，我们希望最小化广告的费用，即想要最小化如下表达式：$$x_1+x_2+x_3+x_4 \tag{29.4}$$    尽管在政治竞选中负面的广告宣传时常发生，但是不可能有负的广告费。因此，我们要求：$$x_1 \ge 0, x_2 \ge 0, x_3 \ge 0, x_4 \ge 0 \tag{29.5}$$

将不等式 $(29.1) \sim (29.3)$ 以及 $(29.5)$ 和最小化目标式 $(29.4)$ 联系起来，我们得到“线性规划”问题。我们将这个问题形式化为：
- 最小化：$$x_1 + x_2 + x_3 + x_4 \tag{29.6}$$
- 满足约束条件：$$-2x_1 + 8x_2 + 0x_3 + 10x_4 \ge 50 \tag{29.7}$$ $$5x_1 + 2x_2 + 0x_3 + 0x_4 \ge 100 \tag{29.8}$$ $$3x_1 - 5x_2 + 10x_3 - 2x_4 \ge 25\tag{29.9}$$ $$x_1 , x_2 , x_3 , x_4 \ge 0 \tag{29.10}$$ 这个线性规划的解，可得出一个最优策略。

## 1.2 一般线性规划
在一般线性规划问题中，我们希望优化一个**满足一组线性不等式约束的线性函数**。已知一组实数 $a_1, a_2, \dots, a_n$ 和一组变量 $x_1, x_2, \dots, x_n$ ，我们给出定义在这些变量上的一个**线性函数** `linear function` $f$ ：$$f(x_1, x_2, \dots, x_n) = a_1 x_1 + a_2 x_2 + \dots + a_n x_n = \sum^n_{j = 1} a_jx_j$$ 如果 $b$ 是一个实数而 $f$ 是一个线性函数，则等式：$$f(x_1, x_2, \dots, x_n)= b$$ 是**线性等式** `linear equality` ，而不等式：$$f(x_1, x_2, \dots, x_n) \le b \\ f(x_1, x_2, \dots, x_n) \ge b$$ 是**线性不等式** `linear inequalities` 。我们使用一般的词语**线性约束** `linear constraints` 来表示线性等式或线性不等式。在线性规划中，不允许严格的不等式——即约束条件都包含等号。

形式化地描述如下：一个**线性规划问题** `linear-programming problem` 是一个线性函数最小化或最大化的问题，该线性函数服从一组有限个线性约束。如果我们要最小化，则称此线性规划为**最小线性规划** `minimization linear program` ；如果我们要最大化，则称此线性规划为**最大化线性规划** `maximization linear program` 。

如果有一个线性规划，其变量为 $x = (x_1, x_2, \dots, x_n)$ ，并且希望引用这些变量的一个特定值，我们将使用记号 $\overline{x}  = (\overline{x_1}, \overline{x_2}, \dots, \overline{x_n})$ 。
 
下面将介绍线性规划的形式化和求解。==虽然已经有一些线性规划的多项式时间算法，但暂时不研究它们。取代地，我们将学习单纯形算法，它是最古老的线性规划算法==。**单纯形算法** `simplex algorithm` 的最坏情况运行时间不是多项式阶的，但它在实际应用中相当高效，因此得到广泛应用。

## 1.3 线性规划综述
**为了描述线性规划的性质和算法，我们发现使用规划形式来表示它们是很方便的**。这里使用两种形式：**标准**和**松弛** `standard and slack` 。下节将给出它们的精确定义。非正式地，在标准型中的线性规划，是满足**线性不等式约束**的一个线性函数的最大化，而松弛类型的线性规划是满足**线性等式约束**的线性函数的最大化。==我们通常使用标准型来表示线性规划，但当描述单纯形算法的细节时，使用松弛形式会比较方便==。从现在开始，我们将注意力放在——满足一组具有 $m$ 个线性不等式约束的、具有 $n$ 个变量的线性函数的最大化上。

首先考虑下面具有两个变量的线性规划：
- 最大化：$$x_1 +x_2 \tag{29.11}$$
- 满足约束：$$4x_1 - x_2 \le 8 \tag{29.12}$$ $$2x_1 + x_2 \le 10\tag{29.13}$$ $$5x_1 - 2x_2 \ge -2 \tag{29.14}$$ $$x_1, x_2 \ge 0 \tag{29.15}$$

我们称所有满足约束式 $(29.12) \sim (29.15)$ 的变量 $x_1, x_2$ 的取值为线性规划的一个**可行解** `feasible solution` 。如果我们在 $(x_1, x_2)$ 笛卡尔坐标系统中画出这些约束，如图29-2(a)所示，我们可以看到**可行解的集合**（图形是阴影部分） 在二维空间中构成一个凸区域（凸区域的直观解释是，该区域的任意两点之间连一条线段，线段上的点也全在该区域中），这个凸区域称为**可行区域** `feasible region` ，希望最大化的函数称为**目标函数** `objective function` 。概念上，我们可在可行区域内每个点上对目标函数 $x_1 +x_2$ 求值；我们将目标函数在一个特定点上的值称为**目标值** `objective value` 。接下来，我们可以找出一个有最大目标值的点作为最优解。在这个例子中（以及大多数线性规划中），可行区域包含无限数目的点，所以**我们希望找出一个高效的方式、以找到一个取最大目标值的点，而无需在可行区域的每个点上对目标函数求值**。
![在这里插入图片描述](https://img-blog.csdnimg.cn/4a4bf7ac47fb4c27a2493dbff7fb3ea2.png)
在二维中，我们可以通过一个图形化的步骤来求最优解。对任意给定的 $z$ ，$x_1 + x_2 = z$ 上点的集合是斜率为 $-1$ 的一条直线。如果画出 $x_1+x_2 = 0$ ，则得到通过原点的斜率为 $-1$ 的直线，如图29-2(b)所示，这条直线和可行区域的交集是一个目标值为 $0$ 的可行解的集合。在这种情形下，此直线和此可行区域的交集是单点 $(0, 0)$ 。更一般地，==对任意的 $z$ ，直线 $x_1 + x_2 = z$ 与可行区域的交集是目标值为 $z$ 的可行解的集合==。图29-2(b)表示了直线 $x_1 + x_2 = 0, x_1 + x_2 = 4, x_1 + x_2 = 8$ 。==因为在图29-2中可行区域是有界的，所以必定存在某个最大值 $z$ ，使得直线 $x_1 + x_2 = z$ 和可行区域的交集非空。任何让此情况出现的点，都是线性规划的一个最优解==。在本例中，最优解是 $x_1 = 2, x_2 = 6$ ，目标值是 $8$ 。

**线性规划的最优解出现在可行区域的一个顶点上，并不是偶然的**。 直线 $x_1 + x_2 = z$ 与可行区域相交的 $z$ 的最大值必在可行区域的边界上，因此这条直线与可行区域的边界的交集要么是一个单独顶点，要么是一条线段。如果交集是一个单独顶点，那么只有一个最优解，就是该顶点。如果交集是一条线段，那么此线段上的每一点必有相同的目标值；特别地，此线段的两个端点都是最优解。因为线段的每个端点都是一个顶点，所以此情况下一个最优解也在一个顶点上。

虽然不容易用图形表示超过两个变量的线性规划，但是同样的直觉仍然成立。如果有三个变量，则每个约束对应于三维空间的一个半空间 `half-space` ，这些半空间的交集形成可行区域。目标函数取目标值 $z$ 的点集合，现在是一个平面（假设没有退化的情形出现）。如果目标函数的系数都是非负的，而且如果原点是线性规划的一个可行解，那么当把这个平面沿目标函数的垂直方向移开原点时 `move this plane away from the origin, in a direction normal to the objective function` ，我们就找到一系列的点，其目标值是递增的（如果原点不是可行解，或者目标函数的某些系数是负的，则直观图形会变得稍微复杂些）。如同在二维空间一样，因为可行区域是凸的，取得最优值的点集合必然包含可行区域的一个顶点。类似地，==如果有 $n$ 个变量，每个约束定义了 $n$ 维空间中的一个半空间。我们称这些半空间的交集形成的可行区域为**单纯形**。目标函数现在是一个超平面，并且因为其凸性 `convexity` ，一个最优解仍在单纯形的一个顶点上取得==。

**单纯形算法**以一个线性规划作为输入，输出一个最优解。
- 它从单纯形的某个顶点开始，执行顺序迭代。
- 在每次迭代中，它沿着单纯形的一条边、从当前顶点移动到一个目标值不小于（通常是大于）当前顶点的相邻顶点。
- 当达到一个局部的最大值，即存在一个顶点，所有相邻顶点的目标值都小于该顶点的目标值，单纯形算法终止。

==因为可行区域是凸的，且目标函数是线性的，所以该局部最优实际上是全局最优的==。（算导29.4节中）我们将使用“对偶”的概念，说明单纯形算法输出解确实是最优的。

尽管几何视角给出了单纯形算法操作过程的一个很好的直观解释，但（在算导29.3节）详细阐述单纯形算法的细节时，我们将不会再直接谈到几何的视角。取而代之，我们采用一种代数的视角。首先将给定的线性规划写成松弛形式，即线性等式的集合，这些线性等式通过其他称为“**非基本变量** `nonbasic variables` ”的变量、来表示某些称为“**基本变量** `basic variables` ”的变量。我们从一个顶点移动到另一个顶点，通过将一个基本变量变为非基本变量、以及将一个非基本变量变为基本变量 `by making a basic variable become nonbasic and making a nonbasic variable become basic` ，我们称这个操作为一个“**主元** `pivot` ”，且从代数的角度，它只不过是将线性规划重写成等价的松弛型。

上述双变量的例子是非常简单的。（算导第29章）下面讨论几个更详细的例子。这些问题包括识别**无解的线性规划** `linear programs that have no solutions` 、**无有限最优解的线性规划** `linear programs that have no finite optimal solution` 、以及**原点不是可行解的线性规划** ` linear programs for which the origin is not a feasible solution` 。
## 线性规划的应用
线性规划应用众多，可见运筹学的教科书。下面给出一个例子：
- 一家石油公司想确定在何处钻井采油。在一个特定位置钻井有相应的费用、且根据地质勘探结果，还可以知道可供开采的石油的桶数。这家公司用来布置新油井的预算有限，希望在这个预算下，让回报的石油量最大。

我们也使用线性规划来建模与求解**图与组合问题**（如算导24.4节，用来求解差分约束系统的线性规划；算导29.2节，如何将一些图和网络流问题形式化为线性规划问题；算导35.4节，利用线性规划作为一种工具，来找出另一个图问题的近似解。

## 线性规划算法
这里研究单纯形算法。当此算法被精心实现时，在实际中通常能够快速解决一般的线性规划问题。然而对于某些刻意仔细设计的输入，单纯形算法会需要指数时间。
- 线性规划的第一个多项式时间算法是**椭球算法** `ellipsoid algorithm` ，它在实际中运行缓慢。
- 第二类多项式时间的算法称为**内点法** `interior-point methods` ，与单纯形算法（即沿着可行区域的外部移动，并在每次迭代中维护一个对应单纯形顶点的可行解）相比，这类算法在可行区域的内部移动。中间阶段的解尽管是可行的，但未必是单纯形的顶点，只是最终的解是一个顶点。对于大规模的输入，内点算法的性能可与单纯形算法相当，有时甚至会更快。
- 如果我们在一个线性规划中加入额外的要求，所有的变量都取整数值，那么就得到了一个**整数线性规划** `integer linear program` 。（算导练习34.5-3）要求证明，仅找出此问题的一个可行解就是NP难的；因为还没有已知的多项式时间算法能解任意一个NP难的问题，于是还没有已知的整数线性规划的多项式时间算法。相比而言，**我们可以在多项式时间内求解一般的线性规划问题**。



---
# 2. 标准型和松弛型
本节介绍两种「在描述和使用线性规划时」有用的形式：标准型和松弛型。**在标准型中，所有的约束都是不等式；在松弛型中，约束都是等式（除非要求变量非负的约束）**。

## 2.1 标准型
在标准型中，我们已知 $n$ 个实数 $c_1, c_2, \dots, c_n$ ；$m$ 个实数 $b_1, b_2, \dots, b_m$ ；以及 $mn$ 个实数 $a_{ij}$ ，其中 $i = 1, 2, \dots, m,\ j = 1, 2, \dots, n$ 。我们希望找到 $n$ 个实数 $x_1, x_2, \dots, x_n$ 。
- 最大化：$$\sum^n_{j=1} c_j x_j \tag{29.16}$$
- 满足约束条件：$$\sum^m_{j=1} a_{ij} x_j \le b_i, \ i = 1, 2, \dots , m \tag{29.17}$$ $$x_j \ge 0, j = 1, 2, \dots, n \tag{29.18}$$
![加粗样式](https://img-blog.csdnimg.cn/0a9eb114e2124fa6995bc6a74ed458cd.png)
 5页！
![在这里插入图片描述](https://img-blog.csdnimg.cn/90e3087f357c4e468d8985bc609f4e3b.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/4327b85e275043cea48f190067890953.png)![在这里插入图片描述](https://img-blog.csdnimg.cn/8f3253a3814849f1997f23baff23e59e.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/dd88991578304ad8a83e1eba948b6dfa.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/74b489da398641fdbc56ee7c6fd13ef6.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/c3b0200d35604f29a078d3c8fd44019f.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/d246d678e0f544a8b5a2fefac49f1b7d.png)

4页


---
# 3. 将问题表达为线性规划
![在这里插入图片描述](https://img-blog.csdnimg.cn/91a45656549048cdb5ae8d43124eca13.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/19f59ea1c2154908b3bc19e79081f1c9.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/dd227c852f5e4f6db4a4a35c1df67843.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/869e85cd5680477e9b3928500158ac93.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/5edefa8adc5547f1ad9780f29e1e7191.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/925c650a363b42328da0b31e9b905746.png)

---
# 29.3 单纯形算法
**单纯形算法是求解线性规划的经典方法**。和其他算法相较而言，它的执行时间在最坏情况下并不是多项式。然而它确实让我们对线性规划有深刻的理解，并在实际中此算法通常相当快速。

除了稍早描述的几何解释外，单纯形算法与（算导28.1节讨论的）高斯消元法有些类似。
![在这里插入图片描述](https://img-blog.csdnimg.cn/345e213a597c4109ac0ac96289c6ff72.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/ab087973c90647ddb6def8070a340131.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/46b444225eeb4b6ebcf414b250328645.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/1d24042942f849a6af77c7b0df3dd112.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/749e98b4d1d9479da45ab95c78690fb4.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/37aee27e37ed4149b9fce9740770e2f8.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/e0c8760b858d4dd0bb5cfd88ffc9025a.png)
	![](https://img-blog.csdnimg.cn/558fb8c3042b42648e82f600bbc51727.png)
	![在这里插入图片描述](https://img-blog.csdnimg.cn/a9da091338724c33b37800c904165377.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/11493210bbf441abb013d229638e2352.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/1ffe6e1a8151430fb249d58f5bb191fd.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/bdea2084ab2a4753aa536a7b1cabc729.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/e879e25c94704ef6a51502a1436ccafb.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/67df03de926c4d918c3c2df8f10b6ea6.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f3446ed10f1c4543bf9f47a7242ed1d3.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/15fb9db53b52436b8c26aec96cfa7fcd.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/6144ea861cda4349a6d0715579cce7ad.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/7df7940b9c51460a86485b0f1cf458d7.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/1e12ba374e0d4ebe93127b790e124dea.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/91dd0a29056844c3b3eab86e54a1be9e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/7657629a755e40a68180e9e0a841c911.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/084b8cba8f3945fdb3f3484734611b85.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b154be36448e468691d2a04818ebf354.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/5085ee8f3c92454886405d2b816c05cb.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/1b6f5d257b0a405894d43c5e00df89da.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/a735682c93654cc4ad7c2d87990f9e2e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/3162201d5c62469b87aabd6722f55bf0.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/23a292fe3f3a4ae29758d58a807d0859.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/4c3a23cdc90047a794397e61b3baa5e4.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/db3a2f17ee2c473d90804b50204e677e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/454d6857f41e488f995ebf2ebb155750.png)


到这里有31页！
