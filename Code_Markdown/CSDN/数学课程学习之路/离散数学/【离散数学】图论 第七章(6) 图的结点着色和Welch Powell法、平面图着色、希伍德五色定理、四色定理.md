> 本文属于「离散数学」系列文章之一。这一系列着重于离散数学的学习和应用。由于内容随时可能发生更新变动，欢迎关注和收藏[离散数学系列文章汇总目录](https://memcpy0.blog.csdn.net/article/details/119997004)一文以作备忘。此外，在本系列学习文章中，为了透彻理解数学知识，本人参考了诸多博客、教程、文档、书籍等资料。以下是本文的不完全参考目录，在后续学习中还会逐渐补充：
> - （**国外经典教材**）离散数学及其应用 第七版 `Discrete Mathematics and Its Applications 7th` ，作者是 `Kenneth H.Rosen` ，袁崇义译，机械工业出版社
> - 离散数学 第二版，武波等编著，西安电子科技大学出版社，2006年


@[toc]

---
# 7.6 图的着色
与**平面图**密切相关的一个重要问题是**图的着色**问题：
> 历史简介：
> - 1852年，英国大学生格思里 `Guthrie` 通过观察地图着色，提出了**四色猜想**，即**仅用四种颜色就能对地图着色、使得相邻国家着色不同**。
> - 1879年，肯普 `Kemple` 发表了一篇论文，宣称自己完成了四色猜想成立的证明。肯普的证明方法很巧妙，人们普遍相信此问题已圆满解决。
> - 1890年，希伍德 `Heawood` 发现肯普的证明是错误的，但借用肯普的技巧证明了**五色定理**。
> - 此后的几十年时间里，虽然不少人在四色猜想上耗费了大量精力，但依然一无所获。
> - 直到1976年，美国伊利诺伊大学的肯尼斯·阿佩尔 `Kenneth Appel` 和沃尔夫冈·哈肯 `Wolfgang Haken` 给出了四色猜想为真的机器证明，该证明过程在计算机上运行了1200多个机时，完成了一百多亿次逻辑判断。

**图的着色**分为**结点着色**和**边着色**两种，下面仅介绍关于图的结点着色的概念和基本理论。

## 7.6.1 图的结点着色
**定义6.1.1** 设 $G = \lang V, E\rang$ 是无向图，给图 $G$ 中的每个结点指定一种颜色，若满足两个邻接的结点着色不同，则称为图 $G$ 的**结点正常着色** `proper coloring` 。如果可以用 $k$ 种不同的颜色给图 $G$ 的结点正常着色，则称 $G$ 是**结点可 $k$-着色的** `k-colorable` 。对图的结点正常着色所需要的最少的颜色数，称为 $G$ 的**顶着色数**，简称为**色数** `chromatic number` ，记为 $\chi (G)$ 。色数为 $k$ 的图称为 **$k$ 色图**。

用**韦尔奇·鲍威尔 `Welch Powell` 法**，可对任意图 $G$ 的结点进行**正常着色**，该方法的步骤如下：
1. **将图 $G$ 中的结点按度数递减的次序进行排列**。当然，如果有相同度数的点，这种排列是不唯一的，但不影响算法的最终结果。
2. 用一种与已着色结点所着颜色不同的、新的颜色 $C$ ，对排列最靠前的、尚未着色的结点着色。再按排列次序，对与**前面已着上颜色 $C$ 的结点**均不邻接的每一结点，着同样的颜色 $C$ 。
3. **反复重复步骤2**，直到所有结点全部着色为止。

【例1】分别对图7.6.1所示的图 $G$ 和 $H$ 中的结点进行正常着色。
<img src="https://img-blog.csdnimg.cn/a454d7e1e04f409e9a153548435b5522.png#pic_center" width="45%">

解：（1）用韦尔奇-鲍威尔法对 $G$ 进行着色，整个过程如图7.6.2所示。
首先将 $G$ 中结点按照度数由大到小排序，得到序列 $\{ b, c, d, e, f, a, g\}$ 。然后，将结点 $b$ 着上红色，并且将与 $b$ 不邻接的结点 $f$ 也着上红色，**注意 $g$ 与 $b$ 不邻接、但与 $f$ 邻接，$f$ 已着上红色，所以 $g$ 不能着上红色**；其次，将结点 $c$ 着上黄色，并将与 $c$ 不邻接的 $e$ 着上黄色；接下来，将结点 $d$ 着上蓝色，并将与 $d$ 不邻接的 $a$ 着上蓝色，**$g$ 与 $d$ 和 $a$ 均不邻接，因此它也可以着上蓝色**。这样，整个着色过程就结束了，$G$ 是**可 $3$-着色的**。
<img src="https://img-blog.csdnimg.cn/3df6fb70104544f4a7ce06e094990bbe.png#pic_center" width="60%">
（2）对于图 $H$ 可用与 $G$ 同样的着色过程，只是在对结点 $g$ 着色时，因为 $g$ 与 $a$ 邻接，所以它不能着蓝色，必须使用一种新的颜色对其着色，因此 $H$ 是**可 $4$-着色的**。

**利用图的色数可以解决很多现实问题**，例如，学校期末考试安排各门课程的考试时间时，不能把同一位学生选修的两门课，安排在同一个时间考试。我们可将每门课程抽象为一个结点，如果两门课程有同一个学生选修，则在这两个结点间连上一条边，构成图 $G$ 。如果 $G$ 的色数为 $k$ ，那么相同颜色的课程可以在同一时间开考，所需考试的最小次数即为 $k$ 。不难发现，考试次数的上界是「学生选修的最多课程数+1」。

**定理7.6.1** 任何图 $G= \langle V, E\rangle$ 均满足 $\chi(G) \le \Delta(G) + 1,\ \Delta(G) = \max \{ deg(u) \mid u\in V\}$ 。
**定理7.6.2** 无向图 $G$ 的色数 $\chi(G) = 2$ ，当且仅当 $G$ 是一个二部图。
以上定理的证明留作练习。

---
## 7.6.2 平面图的着色
地图着色问题，实质上就是对一个**平面图**中的**面**进行着色，它可以通过**对偶图**转换为与之等价的、**平面图**的**结点着色**问题。

**定义7.6.2** 设 $G = \langle V, E\rangle$ 是**平面图**，$G'$ 是 $G$ 的一个**平面嵌入**，$F(G')$ 是 $G'$ 的**面集合**。构造图 $G^*$ ，若 $G^*$ 的结点集合 $V(G^*) = F(G')$ ，且任取两个结点 $f_1,\ f_2 \in V(G^*)$ ，$f_1$ 和 $f_2$ 之间存在边 $e$ 当且仅当 $f_1$ 和 $f_2$ 在 $G'$ 中有一条公共边，则称 $G^*$ 是 $G$ 的**对偶图**。

求平面图 $G$ 的一个平面嵌入 $G'$ 所对应的对偶图 $G^*$ 的一般步骤如下：
（1）对于图 $G$ 的**每个面 $r_i$** ，在 $r_i$ 的内部作**一个结点 $v_i^* \in V(G^*)$** ；
（2）对于**任何两个面 $r_i,\ r_j$ 的每一条公共边界 $e_k$** ，都作**一条与 $e_k$ 相交的边** $e^*_k = \{ v_i^*,\ v_j^*\} \in E(G^*)$ ；
（3）当 **$e_k$ 仅是面 $r_i$ 的边界**时，给 **$v_i^*$ 作一条与 $e_k$ 相交的自回路** $e^*_k = \{ v_i^*,\ v_i^*\} \in E(G^*)$ 。

图7.6.3给出了由图 $G$ 构造其对偶图 $G^*$ 的一个实例，其中，图 $G$ 的结点和边分别用 $\circ$ 和实线表示，而它的对偶图 $G^*$ 的结点和边分别用 $\bullet$ 和虚线表示：
<img src="https://img-blog.csdnimg.cn/af3bccd0941e4dbfba4932fadb6e6e89.png#pic_center" width="30%">

由对偶图的定义可知，**一个连通平面图 $G$ 的对偶图 $G^*$ 也是平面图，$G^*$ 的对偶图是 $G$** ，并且一个平面图的不同平面嵌入，可能得到不同的对偶图。

1890年，希伍德就证明了，**任何连通简单平面图都是可 $5$-着色的**。下面给出其证明过程——定理7.6.3和定理7.6.4。

**定理7.6.3** 设 $G = \langle V, E\rangle$ 是一个**连通简单平面图**，且 $|V| \ge 3,\ |E| = m$ ，则 $G$ 中必存在结点 $u \in V$ ，满足 $deg(u) \le 5$ 。
**证明** 假设 $G$ 中所有结点的度均大于等于 $6$ 。因为 $\displaystyle \sum_{v_i \in V} deg(v_i) = 2m$ ，故 $2m \ge 6|V|$ ，所以 $m \ge 3|V| > 3|V| - 6$ 。这与[**定理7.5.3**]()的结论矛盾。因此，$G$ 中必存在结点 $u \in V$ ，满足 $deg(u) \le 5$ 。

**定理7.6.4**（希伍德五色定理）任一**连通简单平面图** $G = \langle V, E\rangle$ 都是可 $5$-着色的。
**证明** 对图 $G$ 中的结点数进行归纳。
（1）当 $|V| \le 5$ 时，结论显然成立。
（2）假设当 $|V| = k$ 时结论成立，$k \ge 5$ 。
（3）考察 $|V| = k + 1$ 时的情况。由引理知，$G$ 中必然存在结点 $u \in V$ ，满足 $deg(u) \le 5$ 。将结点 $u$ 从图中删去得到图 $G - u$ 。由归纳假设知，$G-u$ 可用 $5$ 种颜色正常着色。现将 $u$ 放回从而恢复原图 $G$ ，分情况讨论：
① $deg(u) < 5$ ，或 $deg(u) = 5$ 但与 $u$ 邻接的 $5$ 个结点所着颜色的数目小于 $5$ ，则在 $G - u$ 所用 $5$ 种颜色中，只要选择一种 $u$ 所邻接的结点未着的颜色进行着色即可；
② $deg(u) = 5$ ，且与 $u$ 相邻的 $5$ 个结点着了 $5$ 种不同的颜色。不妨设使用红色、黄色、蓝色、白色、黑色这五种颜色，对图进行着色，如图7.6.4所示：
<img src="https://img-blog.csdnimg.cn/0567149955e74e3990526b72527ad41d.png#pic_center" width="30%">
约定图 $G - u$ 中所有着红色或黄色的结点集为**红黄集**，$G - u$ 中所有着黑色或白色的结点集为**黑白集**，有以下两种情况：
- $v_1, v_3$ 属于红黄集导出的、 $G$ 的子图的、两个不同的连通分支。如图7.6.5所示，将 $v_1$ 所在分图中的红、黄色对调，并不影响 $G - u$ 的着色；再将结点 $u$ 着上红色，即可对图 $G$ 进行正常着色，如图7.6.6所示：
<img src="https://img-blog.csdnimg.cn/ad3e33d2c7f74eb4af75366bbd03e17b.png" width="45%"><img src="https://img-blog.csdnimg.cn/8524f0eef7494650a4562750e4315da3.png" width="46%">
- $v_1, v_3$ 属于红黄集导出的、$G$ 的子图的、同一个连通分支，则 $v_1, v_3$ 之间必有一条由红黄集中结点构成的路 $P$ ，它加上 $u$ 可构成一个回路 $C(u, P, u)$ 。**由于 $G$ 是平面图，因此，回路 $C$ 会将黑白集分成两个子集**，一个在 $C$ 内，另一个在 $C$ 外，如图7.6.7所示。这样，黑白集导出的子图至少有两个分图，从而将问题转换为上一类问题——将 $v_2$ 所在分图中的黑白色对调，并不影响 $G - u$ 的着色；然后将结点 $u$ 着上白色，即可对图 $G$ 进行正常着色。
<img src="https://img-blog.csdnimg.cn/bd6546957427488b962664c18544d8fc.png#pic_center" width="30%">
 
**定理7.6.5**（四色定理）平面图的色数不超过 $4$ 。
关于该定理的证明，可参考相关文献。
