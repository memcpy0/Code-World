## ç¬¬01èŠ‚ï¼šæ­å»ºå¾®ä¿¡å…¬ä¼—å·ç½‘å…³æœåŠ¡

æœ€åä¿®æ”¹æ¥è‡ªäº**fuzhengwei**Â 1å¹´å‰

[é¡µé¢å†å²](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1/history)[æ–°é¡µé¢](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/new)ç¼–è¾‘

[![](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/1-00.png)](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/1-00.png)

-   ç½‘å…³ï¼š[Lottery-API](https://gitcode.net/KnowledgePlanet/Lottery-API)
-   æè¿°ï¼šåˆ›å»ºæŠ½å¥–ç³»ç»Ÿç½‘å…³å·¥ç¨‹ï¼ŒæŠŠå…¬ä¼—å·å¼€å‘æ¥å£å†™åˆ°è¿™ä¸ªç³»ç»Ÿä¸­ï¼Œæä¾›å¯ä»¥åœ¨å…¬ä¼—å·å‘èµ·æŠ½å¥–çš„å¤„ç†ã€‚

## [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#%E4%B8%80%E5%BC%80%E5%8F%91%E6%97%A5%E5%BF%97)ä¸€ã€å¼€å‘æ—¥å¿—

-   åˆ›å»º Lottery-API ç½‘å…³å·¥ç¨‹ï¼Œå¼•å…¥å…¬ä¼—å·å¼€å‘çš„éªŒç­¾ SDK æœåŠ¡ã€‚_å› ä¸ºè¿™é‡Œæ¶‰åŠäº†ä¸€äº›å…¬ä¼—å·å¼€å‘çš„å¤„ç†ï¼Œå¦‚æœæœ‰äº›çœ‹ä¸æ‡‚ï¼Œå¯ä»¥å‚è€ƒå…¬ä¼—å·çš„å¼€å‘æ–‡æ¡£_
-   ä½¿ç”¨ DDD å››å±‚æ¶æ„åœ¨ç½‘å…³å·¥ç¨‹ä¸­å¼€å‘ç”¨æˆ·å…³æ³¨å…¬ä¼—å·ã€å–æ¶ˆå…³æ³¨å…¬ä¼—å·ä»¥åŠæŠ½å¥–è§¦å‘æµç¨‹ã€‚
-   åœ¨ç½‘å…³å·¥ç¨‹ä¸­é€šè¿‡RPCè°ƒç”¨æŠ½å¥–æœåŠ¡çš„æŠ½å¥–æ¥å£ï¼Œåšç®€å•çš„è°ƒç”¨å¤„ç†ã€‚
-   å¾®ä¿¡å…¬ä¼—å·å¼€å‘æ–‡æ¡£ï¼š[https://developers.weixin.qq.com/doc/](https://developers.weixin.qq.com/doc/)

## [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#%E4%BA%8C%E7%BD%91%E5%85%B3%E5%B7%A5%E7%A8%8B)äºŒã€ç½‘å…³å·¥ç¨‹

ç½‘å…³å·¥ç¨‹ä¸éœ€è¦å¯¹å¤–æä¾› RPC æœåŠ¡ï¼Œåªéœ€è¦æä¾› HTTP æœåŠ¡ï¼Œä»¥åŠåç»­æ‰©å±• SpringCloud ç­‰åŠŸèƒ½ï¼Œæ‰€ä»¥åœ¨å·¥ç¨‹åˆ†å±‚ä¸Šå°±ä¸éœ€è¦å†é¢å¤–åˆ›å»ºå„ä¸ªåˆ†å±‚çš„ module äº†ï¼Œç›´æ¥åœ¨ä¸€ä¸ªåŒ…ä¸‹å°±å¯ä»¥å¤„ç†ï¼Œè¿™æ ·å¤„ç†ä¹Ÿæ›´åŠ ç´§å‡‘ã€‚

[![](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/1-01.png)](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/1-01.png)

-   DDD å››å±‚æ¶æ„ï¼Œåˆ†ä¸º applicationã€domainã€infrastructureã€interface åˆ†åˆ«å¤„ç†å„è‡ªçš„èŒè´£ã€‚

## [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#%E4%B8%89%E9%AA%8C%E7%AD%BE%E6%B5%81%E7%A8%8B)ä¸‰ã€éªŒç­¾æµç¨‹

-   å…¬ä¼—å·å¼€å‘æœ‰ä¸€å¥—æ ‡å‡†çš„æµç¨‹ï¼Œå¯ä»¥åœ¨å…¬ä¼—å·å¹³å°æŸ¥çœ‹å¼€å‘æ–‡æ¡£ã€‚æ— è®ºä½ ä½¿ç”¨å“ªä¸ªè¯­è¨€ï¼ŒJavaã€PHP ç­‰éƒ½å¯ä»¥åœ¨å¹³å°æ‰¾åˆ°æ–‡æ¡£ã€‚
-   ç”±äºå…¬ä¼—å·åå°é…ç½®ä¸Šæ¥å£åï¼Œä¼šåƒä½ çš„æœåŠ¡å‘èµ·è¯·æ±‚ï¼ŒéªŒè¯æœåŠ¡æ˜¯å¦å¯ç”¨ç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼€å‘è¿™æ ·çš„éªŒç­¾æ¥å£

**cn.itedus.lottery.api.interfaces.WxPortalController**

```
/**
 * å¤„ç†å¾®ä¿¡æœåŠ¡å™¨å‘æ¥çš„getè¯·æ±‚ï¼Œè¿›è¡Œç­¾åçš„éªŒè¯
 * <p>
 * appid     å¾®ä¿¡ç«¯AppID
 * signature å¾®ä¿¡ç«¯å‘æ¥çš„ç­¾å
 * timestamp å¾®ä¿¡ç«¯å‘æ¥çš„æ—¶é—´æˆ³
 * nonce     å¾®ä¿¡ç«¯å‘æ¥çš„éšæœºå­—ç¬¦ä¸²
 * echostr   å¾®ä¿¡ç«¯å‘æ¥çš„éªŒè¯å­—ç¬¦ä¸²
 */
@GetMapping(produces = "text/plain;charset=utf-8")
public String validate(@PathVariable String appid,
                       @RequestParam(value = "signature", required = false) String signature,
                       @RequestParam(value = "timestamp", required = false) String timestamp,
                       @RequestParam(value = "nonce", required = false) String nonce,
                       @RequestParam(value = "echostr", required = false) String echostr) {
    try {
        logger.info("å¾®ä¿¡å…¬ä¼—å·éªŒç­¾ä¿¡æ¯{}å¼€å§‹ [{}, {}, {}, {}]", appid, signature, timestamp, nonce, echostr);
        if (StringUtils.isAnyBlank(signature, timestamp, nonce, echostr)) {
            throw new IllegalArgumentException("è¯·æ±‚å‚æ•°éæ³•ï¼Œè¯·æ ¸å®!");
        }
        boolean check = wxValidateService.checkSign(signature, timestamp, nonce);
        logger.info("å¾®ä¿¡å…¬ä¼—å·éªŒç­¾ä¿¡æ¯{}å®Œæˆ checkï¼š{}", appid, check);
        if (!check) {
            return null;
        }
        return echostr;
    } catch (Exception e) {
        logger.error("å¾®ä¿¡å…¬ä¼—å·éªŒç­¾ä¿¡æ¯{}å¤±è´¥ [{}, {}, {}, {}]", appid, signature, timestamp, nonce, echostr, e);
        return null;
    }
}
```

-   è¿›å…¥éªŒç­¾æµç¨‹åï¼Œæ ¸å¿ƒè°ƒç”¨çš„æ˜¯ SDK æ–¹æ³•ï¼Œ`SignatureUtil.check(token, signature, timestamp, nonce);`

## [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#%E5%9B%9B%E5%AF%B9%E6%8E%A5%E6%8A%BD%E5%A5%96)å››ã€å¯¹æ¥æŠ½å¥–

-   å…¬ä¼—å·çš„æŠ½å¥–å‘èµ·ï¼Œç”±ç”¨æˆ·åœ¨å…¬ä¼—å·é¡µå‘é€æ¶ˆæ¯æ‰§è¡ŒæŠ½å¥–ï¼Œé‚£ä¹ˆè¿™é‡Œå°±éœ€è¦ç›‘å¬ç”¨æˆ·å‘é€ text æ–‡æœ¬æ¶ˆæ¯çš„åŠ¨ä½œï¼Œç›‘å¬åˆ°ä»¥åå¯ä»¥åšä¸€äº›åˆ¤æ–­éªŒè¯ï¼Œä¹‹åæ‰§è¡ŒæŠ½å¥–

### [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#1-%E9%85%8D%E7%BD%AE-dubbo)1. é…ç½® dubbo

```
# è®¾ç½®nacosçš„åœ°å€ï¼ˆé…ç½®ä¸­å¿ƒï¼‰
nacos:
  discovery:
    server-addr: 127.0.0.1:8848

# Dubbo å¹¿æ’­æ–¹å¼é…ç½®ï¼Œå¦‚æœè°ƒç”¨ä¸ç¨³å®šå¯ä»¥ä¿®æ”¹ä¸ºç›´è¿æ¨¡å¼ï¼šhttps://gitcode.net/KnowledgePlanet/Lottery/-/issues/1
dubbo:
  application:
    name: Lottery-API
    version: 1.0.0
  registry:
    address: nacos://127.0.0.1:8848
  protocol:
    name: dubbo
    port: -1
```

-   åœ¨ç³»ç»Ÿè¿ç»´ç« èŠ‚ä¸­ä»¥åŠéƒ¨ç½²äº† nacos æ‰€ä»¥æˆ‘ä»¬åç»­çš„å¯ä»¥ä½¿ç”¨æ³¨å†Œä¸­å¿ƒçš„æ–¹å¼ï¼Œè°ƒç”¨æ¥å£

### [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#2-%E8%B0%83%E7%94%A8%E6%8A%BD%E5%A5%96%E6%8E%A5%E5%8F%A3)2. è°ƒç”¨æŠ½å¥–æ¥å£

**cn.itedus.lottery.api.domain.receive.service.logic.impl.LotteryLogicFilter**

```
@Service
public class LotteryLogicFilter implements LogicFilter {

    @DubboReference
    private ILotteryActivityBooth lotteryActivityBooth;

    @Override
    public String filter(BehaviorMatter request) {

        DrawReq drawReq = new DrawReq();
        drawReq.setuId(request.getOpenId().substring(1, 10));
        drawReq.setActivityId(100001L);

        DrawRes drawRes = lotteryActivityBooth.doDraw(drawReq);
        AwardDTO awardDTO = drawRes.getAwardDTO();

        if (!"0000".equals(drawRes.getCode())) {
            return "æŠ½å¥–ğŸ’ æç¤ºï¼š" + drawRes.getInfo();
        }

        return "æ­å–œğŸ’ æ‚¨å·²ä¸­å¥–ï¼š" + awardDTO.getAwardName() + " - Lottery æŠ½å¥–ç³»ç»Ÿæµ‹è¯•";
    }

}
```

-   å®šä¹‰æ¥å£Â `LogicFilter`Â å¹¶åœ¨å®ç°å±‚åšè‡ªå·±å„ä¸ªä¸šåŠ¡åŠŸèƒ½ç±»ï¼ŒåŒ…æ‹¬ï¼šå…³æ³¨ã€å–æ¶ˆå…³æ³¨ã€æŠ½å¥–ï¼Œç›®å‰è¿™ä¸ªæŠ½å¥–çš„æ–¹å¼è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯ä¸ºäº†ä¸²è”èµ·æ¥æ•´ä¸ªæµç¨‹ã€‚
-   æœ€ç»ˆÂ `LotteryLogicFilter`Â ä¼šè¢«é¢†åŸŸæœåŠ¡çš„å¼•æ“åŒ…è¿›è¡Œè°ƒç”¨ï¼Œä¸²è”æ•´ä¸ªæµç¨‹ã€‚

### [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#3-%E6%8E%A5%E6%94%B6%E5%85%AC%E4%BC%97%E5%8F%B7%E6%B6%88%E6%81%AF)3. æ¥æ”¶å…¬ä¼—å·æ¶ˆæ¯

**cn.itedus.lottery.api.interfaces.WxPortalController**

```
/*
 * æ­¤å¤„æ˜¯å¤„ç†å¾®ä¿¡æœåŠ¡å™¨çš„æ¶ˆæ¯è½¬å‘çš„
 */
@PostMapping(produces = "application/xml; charset=UTF-8")
public String post(@PathVariable String appid,
                   @RequestBody String requestBody,
                   @RequestParam("signature") String signature,
                   @RequestParam("timestamp") String timestamp,
                   @RequestParam("nonce") String nonce,
                   @RequestParam("openid") String openid,
                   @RequestParam(name = "encrypt_type", required = false) String encType,
                   @RequestParam(name = "msg_signature", required = false) String msgSignature) {
    try {
        logger.info("æ¥æ”¶å¾®ä¿¡å…¬ä¼—å·ä¿¡æ¯è¯·æ±‚{}å¼€å§‹ {}", openid, requestBody);
        MessageTextEntity message = XmlUtil.xmlToBean(requestBody, MessageTextEntity.class);
        BehaviorMatter behaviorMatter = new BehaviorMatter();
        behaviorMatter.setOpenId(openid);
        behaviorMatter.setFromUserName(message.getFromUserName());
        behaviorMatter.setMsgType(message.getMsgType());
        behaviorMatter.setContent(StringUtils.isBlank(message.getContent()) ? null : message.getContent().trim());
        behaviorMatter.setEvent(message.getEvent());
        behaviorMatter.setCreateTime(new Date(Long.parseLong(message.getCreateTime()) * 1000L));
        // å¤„ç†æ¶ˆæ¯
        String result = wxReceiveService.doReceive(behaviorMatter);
        logger.info("æ¥æ”¶å¾®ä¿¡å…¬ä¼—å·ä¿¡æ¯è¯·æ±‚{}å®Œæˆ {}", openid, result);
        return result;
    } catch (Exception e) {
        logger.error("æ¥æ”¶å¾®ä¿¡å…¬ä¼—å·ä¿¡æ¯è¯·æ±‚{}å¤±è´¥ {}", openid, requestBody, e);
        return "";
    }
}
```

-   é€šè¿‡æ¥æ”¶å…¬ä¼—å·æ¶ˆæ¯ï¼Œè§£æåè¿›è¡Œå¤„ç†ã€‚ä¸€ä¸ªå…¬ä¼—å·æ¶ˆæ¯ä¼šåŒ…æ‹¬äº‹ä»¶æ¶ˆæ¯å’Œæ–‡æœ¬æ¶ˆæ¯ï¼Œç”¨æˆ·å‘é€çš„æ–‡æœ¬æ¶ˆæ¯ï¼Œæˆ‘ä»¬ä¼šè·å–è¿‡æ¥æ‰§è¡ŒæŠ½å¥–å¹¶è¿”å›ç»“æœã€‚

## [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#%E5%9B%9B%E6%B5%8B%E8%AF%95%E9%AA%8C%E8%AF%81)å››ã€æµ‹è¯•éªŒè¯

ç”±äºç›®å‰æ˜¯åœ¨æœ¬åœ°åšæµ‹è¯•ï¼Œä½†éœ€è¦æŠŠæ¥å£æš´éœ²å‡ºå»ï¼Œæ‰èƒ½è®©å…¬ä¼—å·å¹³å°è°ƒç”¨åˆ°æˆ‘ä»¬æœ¬åœ°çš„æ¥å£ã€‚é‚£ä¹ˆè¿™ä¸ªæš´éœ²çš„æ–¹å¼æˆ‘ä»¬ç›®å‰é€‰æ‹©çš„æ˜¯Â [natapp](https://natapp.cn/)Â å…è´¹å†…å¤–ç©¿é€çš„æ–¹å¼è¿›è¡Œå¤„ç†ã€‚

### [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#1-%E5%90%AF%E5%8A%A8%E5%86%85%E5%A4%96%E7%A9%BF%E9%80%8F%E6%9C%8D%E5%8A%A1)1. å¯åŠ¨å†…å¤–ç©¿é€æœåŠ¡

```
./natapp
```

-   æˆ‘å·²ç»æŠŠè¿™ä¸ªè½¯ä»¶æ”¾åˆ°äº† Lottery -> doc -> assets -> natapp ä¸‹ï¼Œä¸è¿‡ä½ ä¹Ÿå¯ä»¥ä»å®˜ç½‘ä¸‹è½½ä½¿ç”¨

### [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#2-%E9%85%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E9%9C%80%E8%A6%81%E7%9A%84%E5%85%AC%E4%BC%97%E5%8F%B7%E4%BF%A1%E6%81%AF)2. é…ç½®æœåŠ¡éœ€è¦çš„å…¬ä¼—å·ä¿¡æ¯

```
wx:
  config:
    originalid: gh_95b2229b90fb
    appid: wx470537fb2f5bf897
    token: bugstack
```

-   è¿™äº›ä¿¡æ¯ä½ éƒ½å¯ä»¥åœ¨å…¬ä¼—å·ç®¡ç†é¡µè¿›è¡Œè·å–ï¼Œåœ°å€ï¼š[https://mp.weixin.qq.com/](https://mp.weixin.qq.com/)

### [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#3-%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1)3. å¯åŠ¨æœåŠ¡

**å¯åŠ¨ Lottery**

```
2021-12-18 17:55:33.500  INFO 83470 --- [           main] e.OverrideDubboConfigApplicationListener : Dubbo Config was overridden by externalized configuration {dubbo.application.name=Lottery, dubbo.application.qos-enable=false, dubbo.application.version=1.0.0, dubbo.config.multiple=true, dubbo.protocol.name=dubbo, dubbo.protocol.port=-1, dubbo.registry.address=nacos://127.0.0.1:8848, dubbo.scan.base-packages=cn.itedus.lottery.rpc.*}

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v2.6.0)

2021-12-18 17:55:33.568  INFO 83470 --- [           main] cn.itedus.lottery.LotteryApplication     : Starting LotteryApplication using Java 1.8.0_311 on fuzhengweideMacBook-Pro-2.local with PID 83470 (/Users/fuzhengwei/itstack/git/KnowledgePlanet/Lottery/lottery-interfaces/target/classes started by fuzhengwei in /Users/fuzhengwei/itstack/git/KnowledgePlanet/Lottery)
2021-12-18 17:55:33.568  INFO 83470 --- [           main] cn.itedus.lottery.LotteryApplication     : No active profile set, falling back to default profiles: default
```

-   å¯åŠ¨å®Œæˆ Lottery å¯ä»¥åœ¨Â [http://localhost:8848/nacos](http://localhost:8848/nacos)Â æŸ¥çœ‹æ³¨å†Œä¸­å¿ƒ

**å¯åŠ¨ Lottery-API**

```
2021-12-18 20:13:24.137  INFO 94954 --- [           main] e.OverrideDubboConfigApplicationListener : Dubbo Config was overridden by externalized configuration {dubbo.application.name=Lottery-API, dubbo.application.qos-enable=false, dubbo.application.version=1.0.0, dubbo.config.multiple=true, dubbo.protocol.name=dubbo, dubbo.protocol.port=-1, dubbo.registry.address=nacos://127.0.0.1:8848}

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v2.6.0)

2021-12-18 20:13:24.214  INFO 94954 --- [           main] cn.itedus.lottery.api.ApiApplication     : Starting ApiApplication using Java 1.8.0_311 on fuzhengweideMacBook-Pro-2.local with PID 94954 (/Users/fuzhengwei/itstack/git/KnowledgePlanet/Lottery-API/target/classes started by fuzhengwei in /Users/fuzhengwei/itstack/git/KnowledgePlanet/Lottery-API)
2021-12-18 20:13:24.215  INFO 94954 --- [           main] cn.itedus.lottery.api.ApiApplication     : No active profile set, falling back to default profiles: default
2021-12-18 20:13:24.777  INFO 94954 --- [           main] com.alibaba.spring.util.BeanRegistrar    : The Infrastructure bean definition [Root bean: class [org.apache.dubbo.config.spring.beans.factory.annotation.ReferenceAnnotationBeanPostProcessor]; scope=; abstract=false; lazyInit=null; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=nullwith name [referenceAnnotationBeanPostProcessor] has been registered.
```

-   å¯åŠ¨å®Œæˆåæ³¨æ„ä½ è¦æ‹¿åˆ°è¿™æ ·ä¸€ä¸ªæ¥å£ï¼š[http://r6s593.natappfree.cc/wx/portal/wx470537fb2f5bf897](http://r6s593.natappfree.cc/wx/portal/wx470537fb2f5bf897)Â ä¸è¿‡ç½‘å€è¦æ›´æ¢æˆä½ çš„ã€wx470537fb2f5bf897 ä¹Ÿè¦æ›´æ¢æˆä½ çš„ã€‚

### [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#4-%E9%85%8D%E7%BD%AE%E6%8E%A5%E5%8F%A3)4. é…ç½®æ¥å£

[![](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/1-02.png)](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/1-02.png)

-   å…¬ä¼—å·åå°ï¼š[https://mp.weixin.qq.com/advanced/advanced?action=dev&t=advanced/dev&token=422300387&lang=zh_CN](https://mp.weixin.qq.com/advanced/advanced?action=dev&t=advanced/dev&token=422300387&lang=zh_CN)
-   åœ¨åŸºç¡€é…ç½®é‡Œï¼ŒæŠŠæ¥å£é…ç½®ä¸Šï¼Œå‡ºç°éªŒè¯æˆåŠŸï¼Œå°±è¯´æ˜ä½ çš„æœåŠ¡å¯ä»¥ä½¿ç”¨äº†

### [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC01%E8%8A%82%EF%BC%9A%E6%90%AD%E5%BB%BA%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%BD%91%E5%85%B3%E6%9C%8D%E5%8A%A1#5-%E5%9B%9E%E5%A4%8D%E6%8A%BD%E5%A5%96)5. å›å¤æŠ½å¥–

å…¬ä¼—å·æŠ½å¥–

[![](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/1-03.png)](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/1-03.png)

[![](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/1-04.png)](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/1-04.png)

-   å¥½äº†ï¼Œç°åœ¨å°±å¯ä»¥å®Œæ•´çš„çœ‹åˆ°æˆ‘ä»¬çš„æŠ½å¥–è°ƒç”¨å’Œç»“æœè¿”å›äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ¿€åŠ¨ï¼

---

1.  å­¦ä¹ å…¬ä¼—å·å¼€å‘ï¼Œè¿™é‡Œæ¶‰åŠçš„å†…å®¹æ¯”è¾ƒå¤šï¼Œå¯èƒ½åœ¨ä½ è°ƒè¯•çš„æ—¶å€™ä¼šé‡åˆ°é—®é¢˜ï¼Œä¸å¤šå¯ä»¥æ…¢æ…¢æŠ˜è…¾ä¸‹ï¼Œä¸è¦ç€æ€¥
2.  å­¦ä¹ æ¥å£çš„åŒ…è£…å’Œä½¿ç”¨ï¼Œä¸²è”èµ·æ•´ä¸ªæµç¨‹ã€‚

## ç¬¬02èŠ‚ï¼šã€ä½œä¸šã€‘vue H5 å¤§è½¬ç›˜æŠ½å¥–

æœ€åä¿®æ”¹æ¥è‡ªäº**fuzhengwei**Â 1å¹´å‰

[é¡µé¢å†å²](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC02%E8%8A%82%EF%BC%9A%E3%80%90%E4%BD%9C%E4%B8%9A%E3%80%91vue-H5-%E5%A4%A7%E8%BD%AC%E7%9B%98%E6%8A%BD%E5%A5%96/history)[æ–°é¡µé¢](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/new)ç¼–è¾‘

[![](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/2-00.png)](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/2-00.png)

-   VUEï¼š[lottery-front](https://gitcode.net/KnowledgePlanet/lottery-front)
-   æè¿°ï¼šæœ¬ç« èŠ‚æ˜¯ä¸€ä¸ªä½œä¸šç« èŠ‚ï¼Œæˆ‘ä¼šå¸¦ç€ä½ åŸºäºvueæ­å»ºåˆå§‹å·¥ç¨‹ï¼ŒåŠ å…¥æŠ½å¥–æ¨¡å—ä»¥åŠä¸€ä¸ªæ¡ˆä¾‹æ¥å£ã€‚ä¹‹åéœ€è¦ä½ åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå®Œå–„æ•´ä¸ªæŠ½å¥–æµç¨‹çš„è°ƒç”¨å’Œå±•ç¤ºï¼Œè¿™æ ·ä½ å°±å¯ä»¥æŠŠæ•´ä¸ªæŠ½å¥–è¿‡ç¨‹ä¸²è”èµ·æ¥äº†ã€‚

## [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC02%E8%8A%82%EF%BC%9A%E3%80%90%E4%BD%9C%E4%B8%9A%E3%80%91vue%20H5%20%E5%A4%A7%E8%BD%AC%E7%9B%98%E6%8A%BD%E5%A5%96#%E4%B8%80%E5%BC%80%E5%8F%91%E6%97%A5%E5%BF%97)ä¸€ã€å¼€å‘æ—¥å¿—

-   åŸºäº IDEA åˆ›å»º vue å·¥ç¨‹ï¼Œå¹¶åŠ å…¥æ–°çš„æŠ½æ£€æ¨¡å—
-   é€šè¿‡ Lottery-API å¼€å‘æ¥å£ï¼Œç»™æŠ½å¥– vue é¡µé¢è°ƒç”¨ï¼Œè¿™é‡Œéœ€è¦é…ç½®è·¨åŸŸÂ `@CrossOrigin("*")`

## [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC02%E8%8A%82%EF%BC%9A%E3%80%90%E4%BD%9C%E4%B8%9A%E3%80%91vue%20H5%20%E5%A4%A7%E8%BD%AC%E7%9B%98%E6%8A%BD%E5%A5%96#%E4%BA%8Cvue-%E5%B7%A5%E7%A8%8B)äºŒã€vue å·¥ç¨‹

æˆ‘ä»¬æŠŠ vue å·¥ç¨‹å†™åˆ°Â [lottery-front](https://gitcode.net/KnowledgePlanet/lottery-front)Â ä½ åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­é™¤äº†å‚è€ƒè¿™ä¸ªå·¥ç¨‹ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥è‡ªå·±åˆ›å»ºï¼Œåˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š

[![](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/2-01.png)](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/2-01.png)

-   ç‚¹å‡»ä¸‹ä¸€æ­¥å³å¯ï¼Œå®ƒä¼šå¸®ä½ åˆå§‹åŒ–å®Œæˆå·¥ç¨‹ã€‚
-   ä¸€èˆ¬å¼€å‘ vue çš„ä¹ æƒ¯ä½¿ç”¨ vscode ä½ ä¹Ÿå¯ä»¥å°è¯•ä¸‹

## [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC02%E8%8A%82%EF%BC%9A%E3%80%90%E4%BD%9C%E4%B8%9A%E3%80%91vue%20H5%20%E5%A4%A7%E8%BD%AC%E7%9B%98%E6%8A%BD%E5%A5%96#%E4%B8%89%E5%85%B3%E4%BA%8E%E6%8A%BD%E5%A5%96%E9%9D%A2%E6%9D%BF)ä¸‰ã€å…³äºæŠ½å¥–é¢æ¿

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€æ¬¾å«Â [lucky-canvas](https://100px.net/)Â çš„æŠ½å¥–æ’ä»¶ï¼ŒæŒ‰ç…§æ­¥éª¤å®‰è£…å®Œæˆåå³å¯ä½¿ç”¨ï¼š

**1. å®‰è£…æ’ä»¶**

```
# npm å®‰è£…
npm install @lucky-canvas/vue@latest

# æˆ–è€… yarn å®‰è£…
yarn add @lucky-canvas/vue@latest
```

**2. ç„¶åæ‰¾åˆ° main.js å¼•å…¥æ’ä»¶å¹¶ use**

```
// å®Œæ•´åŠ è½½
import VueLuckyCanvas from '@lucky-canvas/vue'
Vue.use(VueLuckyCanvas)
```

è¯¦ç»†ä½¿ç”¨æ–‡æ¡£ï¼š[https://100px.net/usage/vue.html](https://100px.net/usage/vue.html)

[![](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/2-02.png)](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/2-02.png)

## [](https://gitcode.net/KnowledgePlanet/Lottery/-/wikis/%E7%AC%AC-4-%E9%83%A8%E5%88%86-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/%E7%AC%AC02%E8%8A%82%EF%BC%9A%E3%80%90%E4%BD%9C%E4%B8%9A%E3%80%91vue%20H5%20%E5%A4%A7%E8%BD%AC%E7%9B%98%E6%8A%BD%E5%A5%96#%E5%9B%9B%E4%BD%9C%E4%B8%9A%E6%A1%88%E4%BE%8B)å››ã€ä½œä¸šæ¡ˆä¾‹

åœ¨æˆ‘ä»¬çš„ä½œä¸šä¸­ç›®å‰å·²ç»åšä¸€ä¸ªéå¸¸ç®€å•çš„å±•ç¤ºå’Œè°ƒç”¨ï¼Œæ¥ä¸‹æ¥ä½ éœ€è¦å®Œæˆæ•´ä¸ªæŠ½å¥–è¿‡ç¨‹æ¥å£çš„è¡¥å…¨ï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼ç†Ÿæ‚‰æŠ½å¥–è¿‡ç¨‹ã€‚

-   åœ¨ Lottery-API æœåŠ¡ä¸­è¡¥å…¨æ¥å£
-   åœ¨ lottery-front vue å·¥ç¨‹ä¸­å®Œæˆè°ƒç”¨
-   æ‰©å±•ç‚¹ï¼Œå¦‚æœä½ å¯¹å‰ç«¯æœ‰å…´è¶£ï¼Œå¯ä»¥è¡¥å…¨æ•´ä¸ªé¡µé¢çš„å±•ç¤ºæ•ˆæœ

**ç›®å‰ä½œä¸šå·¥ç¨‹ä¸­**

-   å®Œæˆäº†ä¸€ä¸ªæ¡ˆä¾‹æ¥å£ï¼Œç”¨äºæŸ¥è¯¢å¥–å“åˆ—è¡¨ï¼š[http://localhost:9001/api/queryPrizeList](http://localhost:9001/api/queryPrizeList)
-   åœ¨vue å·¥ç¨‹ä¸­å®‰è£…äº†æ’ä»¶Â `cnpm install vue-resource --save`Â ç”¨äºgetè°ƒç”¨

[![](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/2-03.png)](https://gitcode.net/KnowledgePlanet/Lottery/-/raw/master/doc/assets/img/Part-4/2-03.png)