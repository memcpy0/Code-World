RocketMq 事务消息的实现机制？
RocketMQ 提供了事务消息，通过**事务消息**就能达到分布式事务的最终一致，从而实现了可靠消息服务。

发送事务消息的过程

发送方将半事务消息发送到 RocketMQ 服务器。
在 RocketMQ 服务器保存消息之后，它向发送方返回一个 ACK，以确认消息已成功发送。因为该消息是半事务消息，所以在从生产者接收到该消息的第二次确认之前，它被标记为“尚未可交付”。
发送方开始执行本地事务逻辑。
发送方根据本地事务执行结果向服务器提交辅助确认(提交或回滚)。在收到 Commit 状态后，服务器将半事务消息标记为可交付消息，订阅者最终将收到该消息。服务器在收到 Rollback 状态时删除半事务消息，订阅者将不接受该消息。
事务消息回调步骤

当网络断开或应用程序重新启动时，如果在步骤4中提交的第二个确认没有到达服务器，服务器将在一段固定的时间后检查消息。
发送方收到消息后，需要检查与该消息对应的本地事务执行的最终结果。
3.发送方根据检查获得的本地事务的最终状态提交第二次确认，服务器继续按照步骤4操作半事务消息。

作者：LeetCode
链接：https://leetcode.cn/leetbook/read/7-day-interview-hou-duan/d0uzys/
来源：力扣（LeetCode）
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。