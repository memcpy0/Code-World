为了能够重用 **Redis 数据**，且防止系统故障，我们需要将 Redis 中的数据写入到磁盘空间中，即持久化。Redis 提供了两种不同的持久化方法可以将数据存储在磁盘中，一种叫快照 RDB，另一种叫只追加文件 AOF。

RDB：在指定的时间间隔内将内存中的数据集快照写入磁盘，它恢复时将快照文件直接读到内存里。
- 优势：适合大规模的数据恢复；**对数据完整性和一致性要求不高**
- 劣势：在一定间隔时间做一次备份，所以如果 Redis 意外 down 掉的话，**就会丢失最后一次快照后的所有修改**。

AOF：
- **以日志的形式来记录每个写操作，将 Redis 执行过的所有写指令记录下来**（除读取操作外），只许追加文件但不可以改写文件。当 Redis 重启时，会根据日志文件的内容将写指令从前到后执行一次、以完成数据的恢复工作。
- AOF 采用文件追加方式，文件会越来越大，为避免出现此种情况，**新增了重写机制**，当AOF文件的大小超过所设定的阈值时， **Redis 就会启动 AOF 文件的内容压缩，只保留可以恢复数据的最小指令集**。

优势：
- 每修改同步：appendfsync always 同步持久化，每次发生数据变更会被立即记录到磁盘，性能较差但数据完整性比较好
- 每秒同步：appendfsync everysec 异步操作，每秒记录，如果一秒内宕机，有数据丢失
- 不同步：appendfsync no 从不同步

劣势：
- 相同数据集的数据而言 **aof 文件要远大于 rdb 文件，恢复速度慢于 rdb**
- aof运行效率要慢于 rdb，每秒同步策略效率较好，不同步效率和 rdb 相同

