@[toc]

本场比赛为 洛谷 9 月月赛 III & Windy OI Round 4，简称 LGR-092 & WdOI R4。本次月赛是小月赛，并且为洛谷在 CSP-J/S2 2021 之前推出的普及组模拟赛场次之一，不分 Div。

---
# T198444 使用三个系统程度的能力
题目背景

赫卡提亚·拉碧斯拉祖利是拥有三副身体，司掌月球、地球、异界三界地狱的神明。由于与纯狐结盟的缘故，赫卡提亚接触到了幻想乡，以及其他的一些现代科技。

赫卡提亚发现，在人类社会中存在三个非常通用流行的操作系统，也就是 Windows\text{Windows}Windows、Linux\text{Linux}Linux 和 Mac\text{Mac}Mac。这三者就像是赫卡提亚本人的三个身体般，分别占据了很大的市场。

但是赫卡提亚又发现，尽管这三个系统之间的文件可以通过一些方式进行信息流通，可是毕竟存在一些区别：例如换行方面采用的字符的不同。赫卡提亚对此非常感兴趣。

现在赫卡提亚不知道从哪里搞来了一个系统的文本文件，她想知道这个文件是在哪个系统里编辑而成的。你能写个程序帮帮她吗？
题目描述

在 Windows\text{Windows}Windows、Linux\text{Linux}Linux 和 Mac\text{Mac}Mac 系统下，分别采用了三种不同的换行符方式。表示为显式转义符，分别是 \r\n\verb!\r\n!\r\n、\n\verb!\n!\n 和 \r\verb!\r!\r 。现在有一份已经写好了的非空文本文件（里面仅由大小写英文字母、下划线、阿拉伯数字、空格，以及换行符组成）。这个文本文件是在单一系统中写成的，因此保证换行符只会出现上述三种情况之一。

比如，这是一个合法的文本文件：

SCP2021 J rp plus plus
chen zhe AK IOI

Welcome to Hell

现在将其中的换行变为对应的转义符。那么在上述三个系统中，分别会变为以下三种模样：

    Windows\text{Windows}Windows 系统：

SCP2021 J rp plus plus\r\nchen zhe AK IOI\r\n\r\nWelcome to Hell\colorbox{f5f5f5}{\verb!SCP2021 J rp plus plus\r\nchen zhe AK IOI\r\n\r\nWelcome to Hell!}
SCP2021 J rp plus plus\r\nchen zhe AK IOI\r\n\r\nWelcome to Hell​

    Linux\text{Linux}Linux 系统：

SCP2021 J rp plus plus\nchen zhe AK IOI\n\nWelcome to Hell\colorbox{f5f5f5}{\verb!SCP2021 J rp plus plus\nchen zhe AK IOI\n\nWelcome to Hell!\kern{31.5pt}}
SCP2021 J rp plus plus\nchen zhe AK IOI\n\nWelcome to Hell​

    Mac\text{Mac}Mac 系统：

SCP2021 J rp plus plus\rchen zhe AK IOI\r\rWelcome to Hell\colorbox{f5f5f5}{\verb!SCP2021 J rp plus plus\rchen zhe AK IOI\r\rWelcome to Hell!\kern{31.5pt}}
SCP2021 J rp plus plus\rchen zhe AK IOI\r\rWelcome to Hell​

现在你被给定的任务是，根据转换后的文本文件，判断这是哪个系统下编写的文本文件。对于上述三种情况，分别输出 windows、linux 或 mac。
输入格式

输入共一行，为转换后的文本文件。保证文本文件非空，且转换前至少有一个换行符。输入可能包含空格。
输出格式

输出一行一个小写单词，输出此文本文件在哪个系统下编写。
输入输出样例
输入 #1

SCP2021RPplusplus\nchenzheAKIOI\n1plus1equalto2\n

输出 #1

linux

输入 #2

chen_zhe AK IOI\r\nchen_zhe AK NOI\r\n

输出 #2

windows

输入 #3

include iostream\rsigned main return 0\r

输出 #3

mac

说明/提示

样例 444 见下发的附件 system4.in/system4.out\textbf{\textit{system4.in}/\textit{system4.out}}system4.in/system4.out。
数据范围

    对于 40%40\%40% 的数据，保证不存在空格。
    对于 100%100\%100% 的数据，保证输入字符串的长度 ≤105\le 10^5≤105。输入中仅包含大写英文字母、小写英文字母、下划线、数字、空格和转义字符（\r、\n）。

注意

本题中的 \n 及 \r 表示直接写在输入里的一个反斜杠符号跟着一个小写字母 n 或 r，而不是一个真正的转义字符。
附件下载
system.zip 1.25KB
# T198447 兔已着陆
题目背景

铃瑚和清兰是从月之都到达幻想乡的两只月兔。正因为降落到了幻想乡进行调查，因此她们通过开团子屋制作团子出售的方式，在幻想乡生活。

为了应对越发繁荣的市场，她们向河城荷取购置了一台团子机器，可以高效地生产出五颜六色的团子。不同颜色的团子的售价不尽相同。由于每天顾客数量很多，购买的团子数量也不少，所以清兰总是搞不清楚一大堆团子的售价如何。

清兰找到了你，希望你能告诉她每次售出团子时，这些团子的总价格。
题目描述

清兰使用河童的机器可以生产出各种各样颜色的团子。她发现，对于颜色为 c\bm cc 的团子，它的售价为 c\bm cc。同时，团子机器有个特性，那就是生产出来的团子的颜色必然是一段连续的整数。

为了储存已经生产出来的团子，清兰使用了一种类似于「栈」的结构。在一天的开始，这个栈为空栈。现在有 nnn 次操作，分为两种：

    1 l r\colorbox{f0f0f0}{\verb!1 l r!}1 l r​ ：团子机器生产出来了颜色为 l,l+1,⋯r−1,rl,l+1,\cdots r-1,rl,l+1,⋯r−1,r 的团子。清兰将这些团子依次入栈。也就是在栈顶依次加入 l,l+1,l+2,⋯r−1,rl,l+1,l+2,\cdots r-1,rl,l+1,l+2,⋯r−1,r 。
    2 k\colorbox{f0f0f0}{\verb!2 k!}2 k​ ：有一位客人想要购买 kkk 个团子。此时清兰会依次从栈顶取出 kkk 个团子并售出。保证 kkk 不大于当前栈内的团子个数。

你要做的，就是对于每个操作 222 输出这些团子的总价格。
输入格式

第一行有一个整数 nnn，表示操作的个数。
接下来 nnn 行描述一组询问。第一个整数 opopop 表示询问的种类，若为 111 则为操作 111，为 222 则为操作 222。

    对于操作 111，接下来有两个整数 l,rl,rl,r，含义如题面所示。
    对于操作 222，接下来有一个整数 kkk，含义如题面所示。

输出格式

若干行。对于每次操作 222，输出这些团子的售价之和。
输入输出样例
输入 #1

6
1 1 14
2 5
1 14 19
1 1 9
2 8
2 10

输出 #1

60
44
124

说明/提示

样例 222 见下发的附件 stack2.in/stack2.out\textbf{\textit{stack2.in}/\textit{stack2.out}}stack2.in/stack2.out。
数据范围

    对于前 30%30\%30% 的数据，n,l,r≤100n,l,r\le100n,l,r≤100。
    对于另外 20%20\%20% 的数据，l=rl=rl=r。
    对于另外 20%20\%20% 的数据，k≤10k\le 10k≤10。
    对于 100%100\%100% 的数据，1≤n≤5×1051\le n\le 5\times 10^51≤n≤5×105，0≤l≤r≤1060\le l\le r \le 10^60≤l≤r≤106，1≤k≤10121\le k \le 10^{12}1≤k≤1012。

附件下载
stack.zip 3.87MB
# T198446 芙兰的贤者时间
题目背景

标题 QED 有两层意思：序列元素构造题（Question of Element constructional Detail）和芙兰的终符符卡前缀。

芙兰朵露·斯卡蕾特是曾居住在红魔馆地下室的吸血鬼。与众不同的是，芙兰朵露有着彩色结晶的特殊翅膀，与其他吸血鬼蝙蝠一般的翅膀不同：颜色各异的结晶按照顺序一字排开。

芙兰朵露翅膀的彩色结晶的颜色从内到外分别是天蓝、蓝、紫、粉、橙、黄、淡绿和天蓝。因此事实上，芙兰朵露的翅膀很可能就是帕秋莉的「贤者之石」组成的。

但是芙兰朵露并不关心这些，她只关心排列成翅膀形状的贤者之石之间会发生的能量流动——如果一块贤者之石被赋予了能量，就会处于激发态。处于激发态的贤者之石很不稳定——它的能量会向周围的贤者之石射出，以造成能量的转移。

芙兰朵露非常感兴趣。她给出了若干个条件，希望帕秋莉实现。但是进入了贤者时间的帕秋莉不想干活只想看书，于是就交给你了。
题目描述

芙兰朵露从帕秋莉那里搞来了 nnn 块贤者之石，并从左往右排成了一列。帕秋莉可以赋予每块贤者之石一定的能级，这会决定贤者之石之间能量的传递。值得注意的是，能级必须要是正整数，并且不能有两块贤者之石能级相同。

如果第 iii 块贤者之石被赋予了能量（处于激发态），它就会将能量传递给第 i−1i-1i−1 和第 i+1i+1i+1 块里能级较小的那一块。特别地，如果某块贤者之石周围只有一块，那么它只会向这一块发送能量。注意，即使第 iii 块的能级低于第 i−1i-1i−1 和第 i+1i+1i+1 块，它照样可以传输能量。

现在芙兰有 qqq 个条件——每个条件给定两个正整数 s,ts,ts,t，表示如果芙兰激活了第 sss 块贤者之石的能量，那么能量最终会经过第 ttt 块。

然而由于帕秋莉有哮喘的老毛病，设定贤者之石的能级是很费力的。因此，如果存在一种合法的赋予贤者之石能级的方案，请你找出其中字典序最小的那个方案。对于两种方案 A,BA,BA,B，我们称 AAA 的字典序小于 BBB，当且仅当存在一个 ppp，使得 ∀i<p\forall i<p∀i<p 有 Ai=BiA_i=B_iAi​=Bi​，且 Ap<BpA_p<B_pAp​<Bp​。

如果存在合法方案，请你输出字典序最小的方案；否则输出 QED。
输入格式

第一行有两个整数 n,qn,qn,q，表示贤者之石的块数和芙兰的条件个数。
接下来 qqq 行，每行有两个整数 si,tis_i,t_isi​,ti​，描述一组条件。
输出格式

若不存在合法方案，输出 QED；否则输出 nnn 个整数，表示字典序最小的那个方案。
输入输出样例
输入 #1

10 4
1 2
3 7
8 10
5 6

输出 #1

1 4 8 3 7 2 6 10 5 9

说明/提示

输入/输出样例 222 见下发的附件 qed2.in/qed2.out\textbf{\textit{qed2.in}/\textit{qed2.out}}qed2.in/qed2.out。

输入/输出样例 333 见下发的附件 qed3.in/qed3.out\textbf{\textit{qed3.in}/\textit{qed3.out}}qed3.in/qed3.out。
数据范围及约定

对于 100%100\%100% 的数据，0≤q≤5×1050\le q \le 5\times 10^50≤q≤5×105，3≤n≤5×1053\le n \le 5\times 10^53≤n≤5×105，1≤si,ti≤n1\le s_i,t_i \le n1≤si​,ti​≤n。

测试点n≤q≤特殊限制1∼377−4∼6100100−71051−8∼103×1053×105si≤ti11∼1210510−13∼203×1053×105−\def{\arraystretch}{1.5} \begin{array}{|c|c|c|c|} \hline \textbf{测试点} & \bm{n\le} & \bm{q\le} & \textbf{特殊限制} \cr \hline 1\sim 3 & 7 & 7 & - \cr \hline 4\sim6 & 100 & 100 & - \cr \hline 7 & 10^5 & 1 & -\cr \hline 8\sim 10 & 3\times 10^5 & 3\times 10^5 & s_i\le t_i \cr \hline 11\sim 12 & 10^5 & 10 & - \cr \hline 13\sim 20 & 3\times 10^5 & 3\times 10^5 & -\cr \hline \end{array}
测试点1∼34∼678∼1011∼1213∼20​n≤71001053×1051053×105​q≤710013×105103×105​特殊限制−−−si​≤ti​−−​​
附件下载
qed.zip 1.34KB
# T198445 觉姐姐和恋妹妹
题目背景

古明地觉和古明地恋是居住在地灵殿的觉妖怪。古明地觉拥有读心程度的能力，但她的妹妹古明地恋却不具备读心能力。

地灵殿是旧地狱上层的极为空旷的大型别墅建筑。正因如此，古明地恋经常在地灵殿里探索新奇好玩的东西。地灵殿可以被划分出好多好多的房间，每个房间里都有一个装饰物。在古明地恋眼里，每个装饰物都有一个新奇程度（特别地，新奇程度可能为负数，代表恋恋觉得这个物件非常枯燥无味）。

喜欢闲逛的古明地恋，有一天想要探索整个地灵殿。作为姐姐的古明地觉，自然不希望恋恋会失望。也就是说，古明地觉可以通过搬运房间内的物件，移动到新的房间里，来提升恋恋整个游览过程的愉悦程度（即恋恋看到的所有物件的新奇程度之和）。

然而，古明地觉向来是不擅长运动的，因此她不会走很长的路。你现在要做的，就是告诉古明地觉，经过她的清理后，恋恋最多可以获得的愉悦程度的最大值。
题目描述

地灵殿可以看作有一个有 n×mn\times mn×m 间房间组成的矩阵，我们用 (x,y)(x,y)(x,y) 描述一个房间的位置。其中，位于 (i,j)(i,j)(i,j) 的房间里拥有的物件的新奇程度为 wi,jw_{i,j}wi,j​，用一个整数表示（可能为负数）。古明地恋的愉悦度被定义为她看到的所有物件的新奇程度之和。

打扫房间的古明地觉，将会从 (1,1)(1,1)(1,1) 走到 (xs,ys)(x_s,y_s)(xs​,ys​) 。期间，古明地觉只能走到下侧或者右侧的房间（假设古明地觉当前在 (i,j)(i,j)(i,j)，那么她下一步只能走到 (i+1,j)(i+1,j)(i+1,j) 或者 (i,j+1)(i,j+1)(i,j+1)，并且她不会走出地灵殿）。古明地觉走到一个房间时，可以捡起房间内的物件放入背包；她也可以从背包里取出任意若干件物件放在该房间（可以既捡起物品又放置物品）。当然，古明地觉不希望带出地灵殿里的物件，因此结束打扫时，觉的背包里应该没有物件。初始时，背包为空。

接下来，古明地恋将会从 (1,1)(1,1)(1,1) 走到 (xk,yk)(x_k,y_k)(xk​,yk​)，进行自己的旅行。古明地恋将会看到一个房间里所有的物件，并且取得相应的新奇程度。和古明地觉相同，古明地恋同样只会向下侧或者右侧的房间行走。

古明地觉想知道，按照这样的规则，恋恋最终得到的愉悦程度最大是多少。
输入格式

第一行有两个正整数 n,mn,mn,m，描述地灵殿房间的规模。
接下来 nnn 行，每行有 mmm 个整数，其中第 iii 行第 jjj 个整数 wi,jw_{i,j}wi,j​ 描述房间 (i,j)(i,j)(i,j) 内的物件的新奇程度。
接下来一行，输入四个正整数，依次为 xs,ys,xk,ykx_s,y_s,x_k,y_kxs​,ys​,xk​,yk​，意义同题目描述，代表觉与恋的终止位置。
输出格式

输出一行，表示该组数据下古明地恋可以取得的最大愉悦程度。
输入输出样例
输入 #1

4 4
0 4 5 3
3 2 -1 2
-1 3 -3 -1
0 4 2 4
3 3 4 4

输出 #1

22

输入 #2

8 8
46 90 58 59 33 64 66 93
52 25 91 51 96 11 21 6
11 1 68 25 50 90 86 94
73 83 48 80 46 46 81 16
60 61 80 55 83 97 67 47
78 96 59 96 39 7 94 66
29 68 15 61 69 43 7 38
31 29 67 79 71 17 0 97
5 3 2 5

输出 #2

509

说明/提示

样例 333 见下发的附件 koishi3.in/koishi3.out\textbf{\textit{koishi3.in}/\textit{koishi3.out}}koishi3.in/koishi3.out。
样例解释
样例 1 解释

    古明地觉的行走路线是 (1,1)→(2,1)→(2,2)→(2,3)→(3,3)(1,1)\to(2,1)\to(2,2)\to(2,3)\to(3,3)(1,1)→(2,1)→(2,2)→(2,3)→(3,3)，遇到的物件的新奇程度分别是 0,3,2,−1,−30,3,2,-1,-30,3,2,−1,−3。期间，她把在 (2,1)(2,1)(2,1) 拿起的价值为 333 的物件放置在了 (2,2)(2,2)(2,2)。
    古明地恋的行走路线是 (1,1)→(1,2)→(2,2)→(3,2)→(4,2)→(4,3)→(4,4)(1,1)\to(1,2)\to(2,2)\to(3,2)\to(4,2)\to(4,3)\to(4,4)(1,1)→(1,2)→(2,2)→(3,2)→(4,2)→(4,3)→(4,4)，看到的物件的新奇程度分别是 0,4,2+3,3,4,2,40,4,2+3,3,4,2,40,4,2+3,3,4,2,4。加起来得到愉悦程度为 222222。

可以证明，不存在更优的方案。
数据范围及约定

    对于前 10%10\%10% 的数据，满足 1≤n,m≤3;∣wi,j∣≤101\le n,m\le 3;|w_{i,j}|\le 101≤n,m≤3;∣wi,j​∣≤10。
    对于前 30%30\%30% 的数据，满足 1≤n,m≤5;∣wi,j∣≤1021\le n,m\le 5;|w_{i,j}|\le 10^21≤n,m≤5;∣wi,j​∣≤102。
    对于前 60%60\%60% 的数据，满足 1≤n,m≤70;∣wi,j∣≤1051\le n,m\le 70;|w_{i,j}|\le 10^51≤n,m≤70;∣wi,j​∣≤105。
    另有 15%15\%15% 的数据，保证 wi,jw_{i,j}wi,j​ 为非负整数。
    对于 100%100\%100% 的数据，满足 1≤n,m≤300;∣wi,j∣≤1061\le n,m\le 300;|w_{i,j}|\le 10^61≤n,m≤300;∣wi,j​∣≤106。

附件下载
koishi.zip 12.93KB
