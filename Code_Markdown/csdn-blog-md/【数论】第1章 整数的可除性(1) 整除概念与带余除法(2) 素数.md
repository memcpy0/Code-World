  > 本文属于「数论」系列文章之一。这一系列着重于数论算法的学习和应用。由于内容随时可能发生更新变动，欢迎关注和收藏[数论算法系列文章汇总目录](https://memcpy0.blog.csdn.net/article/details/121160248)一文以作备忘。此外，在本系列学习文章中，为了透彻理解数论知识，本人参考了诸多博客、教程、文档、书籍等资料。以下是本文的不完全参考目录，在后续学习中还会逐渐补充：
> - 数论算法，姜建国、臧明相编著，西安电子科技大学出版社

 
@[toc]

---
# 1. 素数的定义及性质
**定义1.1.2** 设整数 $a \ne 0, \pm 1$ ，如果它除了显然约数 $\pm 1, \pm a$ 外没有其他的约数，则称 $a$ 为**素数**（或**质数**、**不可约数**）；若 $a\ne 0, \pm 1$ ，且 $a$ 不是素数，则称 $a$ 为**合数**。
**约定**：本系列文章所说的素数一般指正整数。这是因为当 $a\ne 0, \pm 1$ 时，$a, -a$ 必同时为素数或合数，故由整除的性质知，对正素数成立的结论一般对负素数也成立。

**定理1.1.1**（1）大于 $1$ 的最小正因数必是素数。
（2）$n$ 是正整数，若对所有满足 $2\le p\le \sqrt{n}$ 的 $p$ 而言，有 $p\nmid n$ ，则 $n$ 是素数。
**证明** （1）显然。
（2）反证法。若 $n$ 是合数（数理逻辑中的**假设前提**），则存在 $1< a\le b$ 使得 $n = ab$ ，那么必有 $2 \le a \le \sqrt{n}$（知 $b = \dfrac{n}{a}$ ，则有 $a \le b = \dfrac{n}{a}$ 即 $a^2 \le n$ ）且 $a \mid n$ ，与已知条件矛盾。故 $n$ 必是素数。

定理1.1.1(2)的一个应用，就是减少在素数判断时的运算量，提高判断效率。因为判断一个正奇数 $n (n \gt 2)$ 的素性（即判断 $n$ 是否为素数；**大于 $2$ 的偶数一定不是素数**）的最简单、直观的方法之一就是穷举法。即**用每个小于 $n$ 的奇素数 $q$ 试除 $n$ ，当每个 $q\nmid n$ 时则说明 $n$ 是素数**。而定理1.1.1(2)告诉我们，此时只需要对小于等于 $\sqrt{n}$ 的奇素数 $q$ 进行穷举即可。

**定理1.1.2** 素数有无穷多。（[如何证明素数有无穷多个？知乎](
https://www.zhihu.com/question/427360554)）
**证明** 反证法。
- 假设只有有限个素数（注意：已约定素数一定是正整数），它们是 $p_1, p_2, \dots, p_k$ 。
- 考虑 $a = p_1p_2\dots p_k+1$ ，易知 $a > 2$ 且 $a\ne p_i\ (i = 1, 2, \dots, k)$ ，所以 $a$ 必是合数（$a$ 不在假设的有限个素数中）。从而知必存在素数 $p$ ，使得 $p\mid a$ 。
- 又由假设，知 $p$ 为有限个素数之一且必等于某个 $p_j$ ，于是 $p = p_j$ 一定整除 $p_1p_2\dots p_k$ 。
- 根据**性质1.1.3**，有 $p \mid a - p_1p_2\dots p_k = 1$ 。由于 $p = p_j \ge 2$ ，这一推论是不可能的，矛盾。
- 因此，假设是错误的，即素数必有无穷多个。于是，$a$ 可能是素数（此时 $a$ 就是比 $p_k$ 更大的素数）、也可能是合数……

设 $p_1 = 2, p_2 = 3, p_3 = 5, p_4 = 7, p_5 = 11, \dots$ 是全体素数按大小顺序排成的序列，以及 $a_k = p_1p_2\dots p_k + 1$ ，直接计算可得：
$$\begin{aligned}
&a_1 = 3, a_2 = 7, a_3 = 31, a_4 = 211, a_5 = 2311, \\
&a_6 =  59\cdot 509, a_7 = 19\cdot 97 \cdot 277, a_8 = 347 \cdot 27953 \\
&a_9 = 317 \cdot 703763, a_{10} = 331 \cdot 571 \cdot 34231
\end{aligned}
$$

不难发现，前五个 $a_1 \sim a_5$ 是素数，后五个 $a_6 \sim a_{10}$ 是合数，但 $a_k$ 都有一个比 $p_k$ 更大的素因数。 

数论中目前还未解决的问题之一就是：不知道是否有无穷多个 $k$ 使得 $a_k$ 是素数，也不知道是否有无穷多个 $k$ 使得 $a_k$ 是合数。

【例1】求 $30$ 以内的素数。
解：利用定义1.1.2，直接逐个计算，可知 $30$ 以内的素数有：$$2, 3, 5, 7, 11, 13, 17, 19, 23, 29$$

【例2】试判断 $127$ 的素性。
 解：因为 $11 < \sqrt{127} < 12$ ，故只需用奇素数 $3, 5, 7, 11$ 试除 $127$ 即可，可知 $127$ 为素数。
 
 由此可得到求 $1$ 到 $n$ 之间素数的一种有效算法—— **`Eratosthenes` 埃利特斯拉筛法**。具体来说，==为了求出不超过正整数 $n$ 的全部素数，只要在 $1$ 到 $n$ 的列表中删去 $1$ 和不超过 $n$ 的所有正合数，则剩下的数即为所求素数==。

由定理1.1.1知，不超过 $n$ 的正合数 $a$ 必至少有一个素因数 $p$ ，满足 $2 \le p \le \sqrt{a} \le \sqrt{n}$ ，故==只要先求出不超过 $\sqrt{n}$ 的全部素数 $p_1, p_2, \dots, p_k$ ，并依此将 $1$ 到 $n$ 的列表中除了 $p_1, p_2, \dots, p_k$ 本身以外的数中是「$p_1, p_2, \dots, p_k$ 各自的倍数」的数全部删去，就等于删去了不超过 $n$ 的全部正合数==。然后再删去 $1$ ，剩下的正好就是不超过 $n$ 的全部素数。

例如，欲求出不超过两位数的素数，先构造 $1$ 到 $99$ 间正整数的列表，估计出 $\sqrt{99} < 10$ ，然后求出小于 $10$ 的素数 $2, 3, 5, 7$ ，在列表中删去 $1$ ，再从中分别删去大于 $2, 3, 5, 7$ 且为其倍数的数，即得全部两位数的素数。可知，没有删去的数有：
$$2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, \\
43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97$$

共有 $25$ 个素数，它们就是不超过两位数的全部素数。若再从这 $25$ 个数出发，重复上述过程，就可以找出不超过 $92^2$（更准确的说是小于 $101^2$ ）的全部素数。

当然，数学过程和算法实现之间并不完全相同，学过埃式筛法的实现就会明白这一点。

